<!DOCTYPE html>
<html lang="en">
<head>
	<title>{{title}}</title>
	<meta name="viewport" content="width=device-width" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<style>
		/**
		 * Eric Meyer's Reset CSS v2.0 (http://meyerweb.com/eric/tools/css/reset/)
		 * http://cssreset.com
		 */
		html, body, div, span, applet, object, iframe,
		h1, h2, h3, h4, h5, h6, p, blockquote, pre,
		a, abbr, acronym, address, big, cite, code,
		del, dfn, em, img, ins, kbd, q, s, samp,
		small, strike, strong, sub, sup, tt, var,
		b, u, i, center,
		dl, dt, dd, ol, ul, li,
		fieldset, form, label, legend,
		table, caption, tbody, tfoot, thead, tr, th, td,
		article, aside, canvas, details, embed,
		figure, figcaption, footer, header, hgroup,
		menu, nav, output, ruby, section, summary,
		time, mark, audio, video {
			margin: 0;
			padding: 0;
			border: 0;
			font-size: 100%;
			font: inherit;
			vertical-align: baseline;
		}
		/* HTML5 display-role reset for older browsers */
		article, aside, details, figcaption, figure,
		footer, header, hgroup, menu, nav, section {
			display: block;
		}
		body {
			line-height: 1;
		}
		ol, ul {
			list-style: none;
		}
		blockquote, q {
			quotes: none;
		}
		blockquote:before, blockquote:after,
		q:before, q:after {
			content: '';
			content: none;
		}
		table {
			border-collapse: collapse;
			border-spacing: 0;
		}

		/** Humane.js style */
		html,
		body {
			min-height: 100%;
		}
		.humane,
		.humane-jackedup {
			position: fixed;
			-moz-transition: all 0.6s ease-in-out;
			-webkit-transition: all 0.6s ease-in-out;
			-ms-transition: all 0.6s ease-in-out;
			-o-transition: all 0.6s ease-in-out;
			transition: all 0.6s ease-in-out;
			z-index: 100000;
			filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
		}
		.humane,
		.humane-jackedup {
			font-family: Helvetica Neue, Helvetica, san-serif;
			font-size: 18px;
			letter-spacing: -1px;
			top: 20px;
			left: 30%;
			opacity: 0;
			width: 40%;
			color: #333;
			padding: 10px;
			text-align: center;
			background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAACWCAYAAAAfduJyAAAABmJLR0QA/wD/AP+gvaeTAAAAIklEQVQokWNgYGCQZGJgYGDARTDSQnboGDqsnDt0DKWNLAAkiQFdC+vZNQAAAABJRU5ErkJggg==');
			background: -webkit-gradient(linear, left top, left bottom, color-stop(0, rgba(0,0,0,0.1)), color-stop(1, rgba(0,0,0,0.2))) no-repeat;
			background: -moz-linear-gradient(top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.2) 100%) no-repeat;
			background: -webkit-linear-gradient(top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.2) 100%) no-repeat;
			background: -ms-linear-gradient(top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.2) 100%) no-repeat;
			background: -o-linear-gradient(top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.2) 100%) no-repeat;
			background: linear-gradient(top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.2) 100%) no-repeat;
			background-color: #fff;
			-webkit-border-radius: 3px;
			border-radius: 3px;
			text-shadow: 0 1px 1px rgba(255,255,255,0.8);
			-webkit-box-shadow: 0 1px 2px rgba(0,0,0,0.5);
			box-shadow: 0 1px 2px rgba(0,0,0,0.5);
			-moz-transform: translateY(-100px);
			-webkit-transform: translateY(-100px);
			-ms-transform: translateY(-100px);
			-o-transform: translateY(-100px);
			transform: translateY(-100px);
		}
		.humane p,
		.humane-jackedup p,
		.humane ul,
		.humane-jackedup ul {
			margin: 0;
			padding: 0;
		}
		.humane ul,
		.humane-jackedup ul {
			list-style: none;
		}
		.humane.humane-jackedup-info,
		.humane-jackedup.humane-jackedup-info {
			background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADICAYAAAAp8ov1AAAABmJLR0QA/wD/AP+gvaeTAAAAR0lEQVQokWNISfn/n4mBgeE/EwMDAwMqQYQYmdoGlxgjI4rY//+Dx2nUFRsQZ2ALTrQQp8QL1DWeqASC014y7aCx8QwMDAwA1aZBIulmpvwAAAAASUVORK5CYII=');
			background: -webkit-gradient(linear, left top, left bottom, color-stop(0, rgba(0,0,0,0.7)), color-stop(1, rgba(0,0,0,0.85))) no-repeat;
			background: -moz-linear-gradient(top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.85) 100%) no-repeat;
			background: -webkit-linear-gradient(top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.85) 100%) no-repeat;
			background: -ms-linear-gradient(top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.85) 100%) no-repeat;
			background: -o-linear-gradient(top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.85) 100%) no-repeat;
			background: linear-gradient(top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.85) 100%) no-repeat;
			background-color: #fff;
			color: #fff;
			text-shadow: 0 -1px 1px rgba(0,0,0,0.35);
		}
		.humane.humane-jackedup-success,
		.humane-jackedup.humane-jackedup-success {
			background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADICAYAAAAp8ov1AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVQokc2SMQ4AIAgDD9/K/79QVzWaENTownAJbWnA5SqACkA/Aiy59hczrGVC30Q7y57EmNU5NL5zwln50IMsfZMel+UBKtFBQSLWM9wLAAAAAElFTkSuQmCC');
			background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #62c462), color-stop(1, #57a957)) no-repeat;
			background: -moz-linear-gradient(top, #62c462 0%, #57a957 100%) no-repeat;
			background: -webkit-linear-gradient(top, #62c462 0%, #57a957 100%) no-repeat;
			background: -ms-linear-gradient(top, #62c462 0%, #57a957 100%) no-repeat;
			background: -o-linear-gradient(top, #62c462 0%, #57a957 100%) no-repeat;
			background: linear-gradient(top, #62c462 0%, #57a957 100%) no-repeat;
			background-color: #64ff64;
			color: #fff;
			text-shadow: 0 -1px 1px rgba(0,0,0,0.35);
		}
		.humane.humane-jackedup-error,
		.humane-jackedup.humane-jackedup-error {
			background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADICAIAAACmkByiAAAABmJLR0QA/wD/AP+gvaeTAAAAf0lEQVQokY2TOQ7AIAwER/5mivy/yRc2RQDhA0jhghFYO5bhuS+TZMAoIUMEhhH4loGhfu71cenM3DutWMsaeGKjv3zO5N17KLPJ0+fQD8cpv5uVLPo4vnX0PpXj0nuaaeVzdmw+yXG1O96n2p3kozB757Ni1Z5UPsU9SP8AeAG1kHXE+7RlPAAAAABJRU5ErkJggg==');
			background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #ee5f5b), color-stop(1, #c43c35)) no-repeat;
			background: -moz-linear-gradient(top, #ee5f5b 0%, #c43c35 100%) no-repeat;
			background: -webkit-linear-gradient(top, #ee5f5b 0%, #c43c35 100%) no-repeat;
			background: -ms-linear-gradient(top, #ee5f5b 0%, #c43c35 100%) no-repeat;
			background: -o-linear-gradient(top, #ee5f5b 0%, #c43c35 100%) no-repeat;
			background: linear-gradient(top, #ee5f5b 0%, #c43c35 100%) no-repeat;
			background-color: #ee5f5b;
			color: #fff;
			text-shadow: 0 -1px 1px rgba(0,0,0,0.35);
		}
		.humane-animate,
		.humane-jackedup.humane-jackedup-animate {
			opacity: 1;
			-moz-transform: translateY(0);
			-webkit-transform: translateY(0);
			-ms-transform: translateY(0);
			-o-transform: translateY(0);
			transform: translateY(0);
		}
		.humane-animate:hover,
		.humane-jackedup.humane-jackedup-animate:hover {
			opacity: 0.7;
		}
		.humane-js-animate,
		.humane-jackedup.humane-jackedup-js-animate {
			opacity: 1;
			-moz-transform: translateY(0);
			-webkit-transform: translateY(0);
			-ms-transform: translateY(0);
			-o-transform: translateY(0);
			transform: translateY(0);
		}
		.humane-js-animate:hover,
		.humane-jackedup.humane-jackedup-js-animate:hover {
			opacity: 0.7;
			filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=70);
		}

		/** Custom styles */
		body {
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			font-size: 16px;
		}

		a {
			color: #1badd1;
			text-decoration: underline;
		}

		a:hover {
			color: #1b7498;
		}

		h1 {
			font-size: 2em;
		}

		h2 {
			font-size: 1.8em;
			line-height: 1.2em;
		}

		form,
		h2 {
			margin-bottom: 1.4em;
		}

		form {
			display: block;
		}

        label {
            font-size: 0.8em;
        }

		header {
			color: #fff;
			background: #1badd1;
		}

		header {
			padding: 1.4em;
		}

		article {
			margin: 1.4em;
		}

		pre,
		code {
			padding: 0;
			margin: 0;
		}

		footer {
			margin: 2.8em 1.4em;
		}

		table {
			border: 1px solid #ccc;
			margin-right: 1em;
			table-layout: fixed;
			width: 100%;
		}

		th,
		td {
			text-align: left;
			padding: 0.4em;
			border-bottom: 1px solid #ccc;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		th {
			background-color: #ccc;
		}

		tbody tr:nth-child(odd) {
			background-color: #f7f7f7;
		}

		tr:last-child td {
			border-bottom: none;
		}

		th:first-child,
		td:first-child {
			width: 25%;
			border-right: 1px solid #ccc;
		}

		textarea {
			width: 90%;
			display: inline-block;
			height: 300px;
		}

		.code {
			font-family: monospace, "Lucida Console", Monaco, "Courier New", Courier
		}

		.spaces {
			display: inline-block;
			width: 1.1em;
		}

		.key {
			font-weight: bold;
		}

		.float {
			display: inline-block;
			width: 40%;
			vertical-align: top;
		}

		.float:first-child {
			margin-right: 3%;
		}

		.float:last-child {
			width: 50%;
		}

		.overflow {
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.hidden {
			display: none;
		}

		nav {
			border-bottom: 1px solid #ccc;
			margin-bottom: 0.6em;
		}

		nav ul li {
			display: inline-block;
			font-weight: bold;
			margin-bottom: 0.6em;
		}

		nav ul li:first-child {
			margin-right: 1.4em;
		}

		nav ul li a {
			font-weight: normal;
		}

		nav ul li a.active {
			font-weight: bold;
		}

		nav ul li a:hover {
			cursor: pointer;
		}

		#methods,
		#body {
			margin-bottom: 25px;
		}

		#result {
			margin-top: 25px;
		}

		#result h3 {
			width: 100%;
			border-bottom: 1px solid #ccc;
			padding-bottom: 10px;
			margin-bottom: 10px;
			font-weight: bold;
		}

		@media (max-width: 899px) {
			.float {
				display: block !important;
				width: 100% !important;
			}

			.float:first-child {
				margin-bottom: 25px;
				margin-right: 0 !important;
			}

			table {
				margin: 0 !important;
			}

			footer {
				margin: 50px 10px;
			}
		}

		@media (min-width: 900px) and (max-width: 1280px) {
			.float {
				width: 48% !important;
			}
		}
	</style>
</head>

<body>
<header>
	<h1 class="overflow">{{title}}</h1>
</header>
<article>
	<h2 class="overflow">{{url}}</h2>
	<form>
        <fieldset>
            <label for="formats">Format</label>
            <select id="formats">
                {{formats}}
            </select>
        </fieldset>
	</form>
	<div>
		<div class="float">
			<table>
				<thead>
				<tr>
					<th>Header</th>
					<th>Value</th>
				</tr>
				</thead>
				<tbody>
				{{headers}}
				</tbody>
			</table>
		</div>
		<div id="io" class="float">
			<nav class="hidden">
				<ul>
					<li><a class="active" data-type="code" title="View response">Response</a></li>
					<li><a data-type="form" title="Send a request">Send Request</a></li>
				</ul>
			</nav>
			<div>
				<div class="code">
					<pre><code>{{body}}</code></pre>
				</div>
				<div class="form hidden">
					<form>
						<label for="methods">Method</label>
						<select id="methods">
							{{methods}}
						</select>
						<fieldset id="body">
							<textarea placeholder="JSON is required"></textarea>
						</fieldset>
						<button type="submit">Submit</button> <button type="reset">Reset</button>
						<div id="result" class="hidden">
							<h3>Result</h3>
							<div class="code">
								<pre><code></code></pre>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</article>
<footer>
	<div>Copyright &copy; {{year}} <a href="http://avoidwork.com" title="View my homepage">Jason Mulligan</a><br />
		<a href="http://avoidwork.github.io/tenso" title="View project homepage">Tensō</a> {{version}}</div>
</footer>
<script type="application/javascript">
	!function(){var a,b,c,d;!function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d._eak_seen=e,f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var g,h=e[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)"exports"===i[l]?k.push(g={}):k.push(b(c(i[l])));var n=j.apply(this,k);return f[a]=g||n}}(),a("promise/all",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){f(a,b)}}function f(a,c){h[a]=c,0===--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&e(g.then)?g.then(d(j),c):f(j,g)})}var d=a.isArray,e=a.isFunction;b.all=c}),a("promise/asap",["exports"],function(a){"use strict";function b(){return function(){process.nextTick(e)}}function c(){var a=0,b=new i(e),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function d(){return function(){j.setTimeout(e,1)}}function e(){for(var a=0;a<k.length;a++){var b=k[a],c=b[0],d=b[1];c(d)}k=[]}function f(a,b){var c=k.push([a,b]);1===c&&g()}var g,h="undefined"!=typeof window?window:{},i=h.MutationObserver||h.WebKitMutationObserver,j="undefined"!=typeof global?global:void 0===this?window:this,k=[];g="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?b():i?c():d(),a.asap=f}),a("promise/config",["exports"],function(a){"use strict";function b(a,b){return 2!==arguments.length?c[a]:(c[a]=b,void 0)}var c={instrument:!1};a.config=c,a.configure=b}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){"use strict";function d(){var a;a="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var b="Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;return new a.Promise(function(a){b=a}),f(b)}();b||(a.Promise=e)}var e=a.Promise,f=b.isFunction;c.polyfill=d}),a("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){if(!v(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],j(a,this)}function j(a,b){function c(a){o(b,a)}function d(a){q(b,a)}try{a(c,d)}catch(e){d(e)}}function k(a,b,c,d){var e,f,g,h,i=v(c);if(i)try{e=c(d),g=!0}catch(j){h=!0,f=j}else e=d,g=!0;n(b,e)||(i&&g?o(b,e):h?q(b,f):a===D?o(b,e):a===E&&q(b,e))}function l(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+D]=c,e[f+E]=d}function m(a,b){for(var c,d,e=a._subscribers,f=a._detail,g=0;g<e.length;g+=3)c=e[g],d=e[g+b],k(b,c,d,f);a._subscribers=null}function n(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(u(b)&&(d=b.then,v(d)))return d.call(b,function(d){return c?!0:(c=!0,b!==d?o(a,d):p(a,d),void 0)},function(b){return c?!0:(c=!0,q(a,b),void 0)}),!0}catch(e){return c?!0:(q(a,e),!0)}return!1}function o(a,b){a===b?p(a,b):n(a,b)||p(a,b)}function p(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(r,a))}function q(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(s,a))}function r(a){m(a,a._state=D)}function s(a){m(a,a._state=E)}var t=a.config,u=(a.configure,b.objectOrFunction),v=b.isFunction,w=(b.now,c.all),x=d.race,y=e.resolve,z=f.reject,A=g.asap;t.async=A;var B=void 0,C=0,D=1,E=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;t.async(function(){k(c._state,d,e[c._state-1],c._detail)})}else l(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},i.all=w,i.race=x,i.resolve=y,i.reject=z,h.Promise=i}),a("promise/race",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})}var d=a.isArray;b.race=c}),a("promise/reject",["exports"],function(a){"use strict";function b(a){var b=this;return new b(function(b,c){c(a)})}a.reject=b}),a("promise/resolve",["exports"],function(a){"use strict";function b(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}a.resolve=b}),a("promise/utils",["exports"],function(a){"use strict";function b(a){return c(a)||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),b("promise/polyfill").polyfill()}();
</script>
<script type="application/javascript">
	/*
	 __          .__             .__   ____     ________      ____  ________
	 |  | __ ____ |__| _________  |__| /_   |    \_____  \    /_   |/  _____/
	 |  |/ // __ \|  |/ ___\__  \ |  |  |   |      _(__  <     |   /   __  \
	 |    <\  ___/|  / /_/  > __ \|  |  |   |     /       \    |   \  |__\  \
	 |__|_ \\___  >__\___  (____  /__|  |___| /\ /______  / /\ |___|\_____  /
	 \/    \/  /_____/     \/            \/        \/  \/            \/

	 2015 Jason Mulligan <jason.mulligan@avoidwork.com>
	 */

	"use strict";var _get=function a(b,c,d){var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},_inherits=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},_classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=a.document,c=a.location||{},d=a.navigator,e="undefined"!=typeof process,f="function"==typeof MutationObserver,g=10,h=100,i=500,j=["readystatechange","abort","load","loadstart","loadend","error","progress","timeout"],k=function(){},l=a.Promise||void 0,m=a.localStorage||void 0,n=a.XMLHttpRequest||null,o=a.WeakMap||null,p=a.btoa||void 0,q="undefined"!=typeof Blob&&"undefined"!=typeof Worker,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0;e&&(v=require("url"),s=require("http"),t=require("https"),u=require("mongodb").MongoClient,k=require("buffer").Buffer,"undefined"==typeof l&&(l=require("es6-promise").Promise),"undefined"==typeof m&&(m=require("localStorage")),"undefined"==typeof p&&(p=require("btoa")));var z=function(){var regex={after_space:/\s+.*/,allow:/^allow$/i,allow_cors:/^access-control-allow-methods$/i,and:/^&/,args:/\((.*)\)/,auth:/\/\/(.*)\@/,bool:/^(true|false)?$/,boolean_number_string:/boolean|number|string/,caps:/[A-Z]/,cdata:/\&|<|>|\"|\'|\t|\r|\n|\@|\$/,checked_disabled:/checked|disabled/i,complete_loaded:/^(complete|loaded)$/i,csv_quote:/^\s|\"|\n|,|\s$/,del:/^del/,domain:/^[\w.-_]+\.[A-Za-z]{2,}$/,down:/down/,endslash:/\/$/,eol_nl:/\n$/,element_update:/id|innerHTML|innerText|textContent|type|src/,get_headers:/^(head|get|options)$/,get_remove_set:/get|remove|set/,hash:/^\#/,header_replace:/:.*/,header_value_replace:/.*:\s+/,html:/^<.*>$/,http_body:/200|201|202|203|206/,http_ports:/80|443/,host:/\/\/(.*)\//,ie:/msie|ie|\.net|windows\snt/i,ip:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,is_xml:/^<\?xml.*\?>/,json_maybe:/json|plain|javascript/,json_wrap:/^[\[\{]/,klass:/^\./,no:/no-store|no-cache/i,not_dotnotation:/-|\s/,not_endpoint:/.*\//,null_undefined:/null|undefined/,number:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)|number/,number_format_1:/.*\./,number_format_2:/\..*/,number_present:/\d{1,}/,number_string:/number|string/i,number_string_object:/number|object|string/i,object_type:/\[object Object\]/,patch:/^patch$/,primitive:/^(boolean|function|number|string)$/,priv:/private/,protocol:/^(.*)\/\//,put_post:/^(post|put)$/i,radio_checkbox:/^(radio|checkbox)$/i,root:/^\/[^\/]/,select:/select/i,selector_is:/^:/,selector_complex:/\s+|\>|\+|\~|\:|\[/,set_del:/^(set|del|delete)$/,space_hyphen:/\s|-/,string_object:/string|object/i,svg:/svg/,top_bottom:/top|bottom/i,url:/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i,word:/^\w+$/,xdomainrequest:/^(get|post)$/i,xml:/xml/i},z=function(){function a(){var b=void 0===arguments[0]?1e3:arguments[0];_classCallCheck(this,a),this.cache={},this.max=b,this.first=null,this.last=null,this.length=0}return _createClass(a,[{key:"evict",value:function(){return null!==this.last&&this.remove(this.last),this}},{key:"get",value:function(a){var b=this.cache[a];if(void 0!==b)return this.set(a,b.value),b.value}},{key:"remove",value:function(a){var b=this.cache[a];return b&&(delete this.cache[a],this.length--,null!==b.previous&&(this.cache[b.previous].next=b.next),null!==b.next&&(this.cache[b.next].previous=b.previous),this.first===a&&(this.first=b.previous),this.last===a&&(this.last=b.next)),b}},{key:"set",value:function(a,b){var c=this.remove(a);return void 0===c?c=new A(b):c.value=b,c.next=null,c.previous=this.first,this.cache[a]=c,null!==this.first&&(this.cache[this.first].next=a),this.first=a,null===this.last&&(this.last=a),++this.length>this.max&&this.evict(),this}}]),a}(),A=function aa(a){_classCallCheck(this,aa),this.next=null,this.previous=null,this.value=a},B={factory:function(a){return new z(a)}},C=function(){function a(){var b=void 0===arguments[0]?g:arguments[0];_classCallCheck(this,a),this.limit=b,this.listeners={},this.hooks=new o}return _createClass(a,[{key:"dispatch",value:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return a&&this.listeners[a]&&utility.iterate(this.listeners[a],function(a){a.handler.apply(a.scope,c)}),this}},{key:"hook",value:function(a,b){var c=this;if("function"!=typeof a.addEventListener)throw new Error(T.invalidArguments);var d=this.hooks.get(a)||{};return d[b]=function(a){c.dispatch(b,a)},this.hooks.set(a,d),a.addEventListener(b,this.hooks.get(a)[b],!1),a}},{key:"off",value:function(a,b){return this.listeners[a]&&(b?delete this.listeners[a][b]:delete this.listeners[a]),this}},{key:"on",value:function(a,b){var c=void 0===arguments[2]?utility.uuid():arguments[2],d=void 0===arguments[3]?void 0:arguments[3];if(this.listeners[a]||(this.listeners[a]={}),array.keys(this.listeners[a]).length>=this.limit)throw new Error("Possible memory leak, more than "+this.limit+" listeners for event: "+a);return this.listeners[a][c]={scope:d||this,handler:b},this}},{key:"once",value:function(a,b){var c=this,d=void 0===arguments[2]?utility.uuid():arguments[2],e=void 0===arguments[3]?void 0:arguments[3];return e=e||this,this.on(a,function(){for(var f=arguments.length,g=Array(f),h=0;f>h;h++)g[h]=arguments[h];b.apply(e,g),c.off(a,d)},d,e)}},{key:"unhook",value:function(a,b){var c=this.hooks.get(a);return c&&(a.removeEventListener(b,c[b],!1),delete c[b],0===array.keys(c).length?this.hooks["delete"](a):this.hooks.set(a,c)),a}}]),a}(),D=function(a){return new C(a)},E=function(){function a(){_classCallCheck(this,a),this.observer=null}return _createClass(a,[{key:"addEventListener",value:function(a,b,c,d){return this.observer.on(a,b,c,d||this),this}},{key:"addListener",value:function(a,b,c,d){return this.observer.on(a,b,c,d||this),this}},{key:"dispatch",value:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.observer.dispatch.apply(this.observer,b),this}},{key:"dispatchEvent",value:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.observer.dispatch.apply(this.observer,b),this}},{key:"emit",value:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.observer.dispatch.apply(this.observer,b),this}},{key:"hook",value:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.observer.hook.apply(this.observer,b),this}},{key:"listeners",value:function(a){return a?this.observer.listeners[a]:this.observer.listeners}},{key:"off",value:function(a,b){return this.observer.off(a,b),this}},{key:"on",value:function(a,b,c,d){return this.observer.on(a,b,c,d||this),this}},{key:"once",value:function(a,b,c,d){return this.observer.once(a,b,c,d||this),this}},{key:"removeEventListener",value:function(a,b){return this.observer.off(a,b),this}},{key:"removeListener",value:function(a,b){return this.observer.off(a,b),this}}]),a}(),array={add:function(a,b){return array.contains(a,b)||a.push(b),a},binIndex:function(a,b){for(var c=a.length-1,d=0,e=0,f=0;c>=d;)if(e=Math.floor((d+c)/2),f=a[e],b>f)d=e+1;else{if(!(f>b))return e;c=e-1}return-1},cast:function(a,b){var c=[];return isNaN(a.length)?b===!0?c=array.keys(a):utility.iterate(a,function(a){c.push(a)}):c=Array.from(a),c},chunk:function(a,b){for(var c=[],d=V.round(a.length/b,"up"),e=0,f=-1;++f<d;)e=f*b,c.push(array.limit(a,e,b));return c},clear:function(a){return a.length>0?array.remove(a,0,a.length):a},clone:function(a){var b=void 0===arguments[1]?!0:arguments[1];return utility.clone(a,b)},contains:function(a,b){return a.indexOf(b)>-1},collect:function(a,b){return a.map(b)},compact:function(a,b){var c=a.filter(function(a){return!regex.null_undefined.test(a)});return b!==!0?c:c.length<a.length?c:null},count:function(a,b){return a.filter(function(a){return a===b}).length},diff:function(a,b){var c=void 0;return c=a.filter(function(a){return!array.contains(b,a)}),c=c.concat(b.filter(function(b){return!array.contains(a,b)}))},each:function(a,b,c){var d=void 0===arguments[3]?10:arguments[3],e=a.length,f=void 0,g=void 0;if(c!==!0)for(f=-1;++f<e&&b.call(a,a[f],f)!==!1;);else g=0,d>e&&(d=e),utility.repeat(function(){for(var c=-1,f=void 0;++c<d;)if(f=c+g,f===e||b.call(a,a[f],f)===!1)return!1;return g+=d,g>=e?!1:void 0},void 0,void 0,!1);return a},eachReverse:function(a,b,c,d){var e=a.length,f=void 0,g=void 0;if(c!==!0)for(f=e;--f>-1&&b.call(a,a[f],f)!==!1;);else d=d||10,g=e-1,d>e&&(d=e),utility.repeat(function(){for(var c=-1,e=void 0;++c<d;)if(e=g-c,0>e||b.call(a,a[e],e)===!1)return!1;return g-=d,0>g?!1:void 0},void 0,void 0,!1);return a},empty:function(a){return 0===a.length},equal:function(a,b){return JSON.stringify(a)===JSON.stringify(b)},fill:function(a,b,c,d){var e="function"==typeof b,f=a.length,g=isNaN(c)?0:c,h=isNaN(d)?f-1:g+d;if(h>f-1&&(h=f-1),e)for(;h>=g;)a[g]=b(a[g]),g++;else for(;h>=g;)a[g]=b,g++;return a},first:function(a){return a[0]},flat:function(a){var b=[];return b=a.reduce(function(a,b){return a.concat(b)},b)},forEach:function(a,b,c,d){return array.each(a,b,c,d)},fromObject:function(a){return array.mingle(array.keys(a),array.cast(a))},index:function(a,b){return a.indexOf(b)},indexed:function(a){var b=[];return utility.iterate(a,function(a){b.push(a)}),b},intersect:function(a,b){var c=a.length>b.length?a:b,d=c===a?b:a;return c.filter(function(a){return array.contains(d,a)})},iterate:function(a,b){var c=array.iterator(a),d=-1,e=void 0,f=void 0;do e=c.next(),f=e.done?!1:b(e.value,++d);while(f!==!1);return a},iterator:function(a){var b=-1,c=a.length;return{next:function(){return++b<c?{done:!1,value:a[b]}:{done:!0}}}},keepIf:function(a,b){var c=void 0,d=void 0;return c=a.filter(b),d=array.diff(a,c),array.each(d,function(b){array.remove(a,array.index(a,b))}),a},keys:function(a){return Object.keys(a)},keySort:function(a,b,c){b=b.replace(/\s*asc/gi,"").replace(/\s*desc/gi," desc");var d=string.explode(b).map(function(a){return a.split(" ")}),e=[],f='["',g='"]';return c=c&&""!==c?"."+c:"",array.each(d,function(a){var b=".",d="";regex.not_dotnotation.test(a[0])&&(b=f,d=g),e.push("try {"),"desc"===a[1]?(e.push("if ( a"+c+b+a[0]+d+" < b"+c+b+a[0]+d+" ) return 1;"),e.push("if ( a"+c+b+a[0]+d+" > b"+c+b+a[0]+d+" ) return -1;")):(e.push("if ( a"+c+b+a[0]+d+" < b"+c+b+a[0]+d+" ) return -1;"),e.push("if ( a"+c+b+a[0]+d+" > b"+c+b+a[0]+d+" ) return 1;")),e.push("} catch (e) {"),e.push("try {"),e.push("if ( a"+c+b+a[0]+d+" !== undefined ) return "+("desc"===a[1]?"-1":"1")+";"),e.push("} catch (e) {}"),e.push("try {"),e.push("if ( b"+c+b+a[0]+d+" !== undefined ) return "+("desc"===a[1]?"1":"-1")+";"),e.push("} catch (e) {}"),e.push("}")}),e.push("return 0;"),a.sort(new Function("a","b",e.join("\n")))},last:function(a,b){var c=a.length-1;return b>=c+1?a:isNaN(b)||1===b?a[c]:array.limit(a,c- --b,c)},limit:function(a,b,c){var d=[],e=b-1,f=b+c,g=a.length;if(g>0)for(;++e<f&&g>e;)d.push(a[e]);return d},max:function(a){return array.last(array.sorted(array.clone(a)))},mean:function(a){return a.length>0?array.sum(a)/a.length:void 0},median:function(a){var b=array.sorted(array.clone(a)),c=b.length,d=V.round(c/2,"down");return V.odd(c)?b[d]:(b[d-1]+b[d])/2},merge:function(a,b){return array.each(b,function(b){array.add(a,b)}),a},min:function(a){return array.sorted(array.clone(a))[0]},mingle:function(a,b){var c=a.map(function(a,c){return[a,b[c]]});return c},mode:function ba(a){var b={},c=0,ba=[],d=void 0,e=void 0;return array.each(a,function(a){isNaN(b[a])?b[a]=1:b[a]++}),c=array.max(array.cast(b)),utility.iterate(b,function(a,b){a===c&&ba.push(V.parse(b))}),d=ba.length,d>0&&(e=1===d?ba[0]:ba),e},range:function(a){return array.max(a)-array.min(a)},rassoc:function(a,b){var c=void 0;return array.each(a,function(d,e){return d[1]===b?(c=utility.clone(a[e],!0),!1):void 0}),c},reject:function(a,b){return array.diff(a,a.filter(b))},remove:function(a,b,c){if(isNaN(b)){if(b=array.index(a,b),-1===b)return a}else b=b||0;var d=a.length,e=a.slice((c||b)+1||d);return a.length=0>b?d+b:b,a.push.apply(a,e),a},removeIf:function(a,b){var c=a.filter(b);return array.each(c,function(b){array.remove(a,array.index(a,b))}),a},removeWhile:function(a,b){var c=[];return array.each(a,function(a){return b(a)===!1?!1:void c.push(a)}),array.each(c,function(b){array.remove(a,array.index(a,b))}),a},replace:function(a,b){return array.remove(a,0,a.length),array.each(b,function(b){a.push(b)}),a},rest:function(a){var b=void 0===arguments[1]?1:arguments[1];return 1>b&&(b=1),array.limit(a,b,a.length)},rindex:function(a,b){var c=-1;return array.each(a,function(a,d){a===b&&(c=d)}),c},rotate:function(a,b){var c=a.length,d=void 0;return 0===b?d=a:(0>b?b+=c:b--,d=array.limit(a,b,c),d=d.concat(array.limit(a,0,b))),d},series:function(){var a=void 0===arguments[0]?0:arguments[0],b=void 0===arguments[1]?void 0:arguments[1],c=void 0===arguments[2]?1:arguments[2];b=b||a;for(var d=[],e=-1,f=Math.max(0,Math.ceil((b-a)/c));++e<f;)d[e]=a,a+=c;return d},sort:function(a,b){var c={a:typeof a,b:typeof b},d=void 0,e=void 0,f=void 0;return"number"===c.a&&"number"===c.b?f=a-b:(d=a.toString(),e=b.toString(),f=e>d?-1:d>e?1:c.a===c.b?0:"boolean"===c.a?-1:1),f},sorted:function(a){return a.sort(array.sort)},split:function(a,b){var c=[],d=a.length,e=Math.ceil(d/b),f=Math.floor(d/b),g=Math.ceil(d/e),h=!1,i=0,j=-1;for(V.diff(d,b*e)>e?g=d-f*b+f-1:d%b>0&&g*e>=d&&g--;++j<b;)j>0&&(i+=e),!h&&b>g&&j===g&&(--e,h=!0),c.push(array.limit(a,i,e));return c},stddev:function(a){return Math.sqrt(array.variance(a))},sum:function(a){var b=0;return a.length>0&&(b=a.reduce(function(a,b){return a+b})),b},take:function(a,b){return array.limit(a,0,b)},toObject:function(a){for(var b={},c=a.length;c--;)b[c.toString()]=a[c];return b},total:function(a){return array.indexed(a).length},unique:function(a){var b=[];return array.each(a,function(a){array.add(b,a)}),b},variance:function(a){var b=a.length,c=0,d=void 0;return b>0?(d=array.mean(a),array.each(a,function(a){c+=U.sqr(a-d)}),c/b):c},zip:function(a,b){var c=[];return b instanceof Array||(b="object"==typeof b?array.cast(b):[b]),array.each(b,function(a,c){a instanceof Array||(b[c]=[a])}),array.each(a,function(a,d){c[d]=[a],array.each(b,function(a){c[d].push(a[d]||null)})}),c}},F={lru:B.factory(i),expire:function(a){return F.lru.cache[a]?(F.lru.remove(a),!0):!1},expired:function(a){var b=F.lru.cache[a];return b&&b.value.expires<(new Date).getTime()},get:function(a,b,c){a=utility.parse(a).href;var d=F.lru.get(a);return d?b!==!1&&F.expired(a)||!utility.equal(d.request_headers,c)?(F.expire(a),!1):utility.clone(d,!0):!1},set:function(a,b,c){a=utility.parse(a).href;var d=F.lru.get(a);return d||(d={permission:0}),"permission"===b?d.permission|=c:"!permission"===b?d.permission&=~c:d[b]=c,F.lru.set(a,d),d}},G=function(a){function b(a){var c=this;_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.observer=D(),this.defer=Q(),this.xhr=a,array.each(j,function(a){c.hook(c.xhr,a)})}return _inherits(b,a),_createClass(b,[{key:"always",value:function(a){return this.defer.always.call(this.defer,a)}},{key:"done",value:function(a){return this.defer.done.call(this.defer,a)}},{key:"fail",value:function(a){return this.defer.fail.call(this.defer,a)}},{key:"reject",value:function(a){return this.defer.reject.call(this.defer,a)}},{key:"resolve",value:function(a){return this.defer.resolve.call(this.defer,a)}},{key:"then",value:function(a,b){return this.defer.then.call(this.defer,a,b)}}]),b}(E),H={ab:"undefined"!=typeof ArrayBuffer,blob:"undefined"!=typeof Blob,doc:"undefined"!=typeof Document,ie:!e&&regex.ie.test(d.userAgent),version:function(){var a=0;return H.ie&&(a=V.parse(string.trim(d.userAgent.replace(/( .*msie|;.*)/gi,""))||9,10)),a},allows:function(a,b,c){a=utility.parse(a).href,b=b.toLowerCase();var d=!1,e=0;return F.get(a,!1,c)?(regex.del.test(b)?e=1:regex.get_headers.test(b)?e=4:regex.put_post.test(b)?e=2:regex.patch.test(b)&&(e=8),d=Boolean(H.permissions(a,c).bit&e)):d=void 0,d},bit:function(a){var b=0;return array.each(a,function(a){a=a.toLowerCase(),regex.get_headers.test(a)?b|=4:regex.put_post.test(a)?b|=2:regex.patch.test(a)?b|=8:regex.del.test(a)&&(b|=1)}),b},cors:function(a){return!e&&a.indexOf("//")>-1&&-1===a.indexOf("//"+c.host)},headers:function ca(a,b,c,d){var ca=string.trim(a.getAllResponseHeaders()).split("\n"),e={},f={},g=null,h=new Date,i=H.cors(b),j=!0;return array.each(ca,function(a){var b=a.split(": ");return e[b[0].toLowerCase()]=string.trim(b[1]),null===g&&(!i&&regex.allow.test(b[0])||i&&regex.allow_cors.test(b[0]))?(g=b[1],!1):void 0}),regex.no.test(e["cache-control"])?h=h.getTime():e["cache-control"]&&regex.number_present.test(e["cache-control"])?h=h.setSeconds(h.getSeconds()+V.parse(regex.number_present.exec(e["cache-control"])[0],10)):e.expires?h=new Date(e.expires).getTime():(j=!1,h=h.getTime()),f.cachable=j,f.expires=h,f.headers=e,f.timestamp=new Date,f.permission=H.bit(null!==g?string.explode(g):[c]),"get"===c&&j&&(F.set(b,"expires",f.expires),F.set(b,"headers",f.headers),F.set(b,"timestamp",f.timestamp),F.set(b,"permission",f.permission),F.set(b,"request_headers",d)),f},parse:function(a){var b=void 0===arguments[1]?"":arguments[1],c=void 0,d=void 0;return(regex.json_maybe.test(b)||string.isEmpty(b))&&regex.json_wrap.test(a.responseText)&&Boolean(d=S.decode(a.responseText,!0))?c=d:"text/csv"===b?c=I.decode(a.responseText):"text/tsv"===b?c=I.decode(a.responseText,"	"):regex.xml.test(b)?("text/xml"!==b&&a.overrideMimeType("text/xml"),c=a.responseXML):c="text/plain"===b&&regex.is_xml.test(a.responseText)&&$.valid(a.responseText)?$.decode(a.responseText):a.responseText,c},permissions:function(a,b){var c=F.get(a,!1,b),d=c?c.permission:0,e={allows:[],bit:d,map:{partial:8,read:4,write:2,"delete":1,unknown:0}};return 1&d&&e.allows.push("DELETE"),2&d&&(e.allows.push("POST"),e.allows.push("PUT")),4&d&&e.allows.push("GET"),8&d&&e.allows.push("PATCH"),e},jsonp:function(b,c){var d=Q(),e="callback",f=void 0,g=void 0;void 0===r&&(a.keigai||(a.keigai={callback:{}}),r="keigai"),c instanceof Object&&!c.callback&&(e=c.callback);do f=utility.genId().slice(0,10);while(a.callback[f]);return b=b.replace(e+"=?",e+"="+r+".callback."+f),a.callback[f]=function(b){utility.clearTimers(f),delete a.callback[f],d.resolve(b),R.destroy(g)},g=R.create("script",{src:b,type:"text/javascript"},utility.dom("head")[0]),utility.defer(function(){utility.clearTimers(f),delete a.callback[f],d.reject(new Error(T.requestTimeout))},3e4,f),d},kxhr:function(a){return new G(a)},request:function(a){var b=void 0===arguments[1]?"GET":arguments[1],c=void 0===arguments[2]?void 0:arguments[2],d=void 0===arguments[3]?void 0:arguments[3];a=utility.parse(a).href,b=b.toLowerCase(),d=d instanceof Object?d:null;var f=H.cors(a),g=H.kxhr(!H.ie||!f||H.version>9?new n:new XDomainRequest),h=(regex.put_post.test(b)||regex.patch.test(b))&&c?c:null,i="get"===b?F.get(a,!1,d):!1,j=null,l=H.doc,m=H.ab,o=H.blob;if(H.ie&&9===H.version&&f&&!regex.xdomainrequest.test(b))throw new Error(T.notAvailable);return g.on("readystatechange",function(a){var b=g.xhr.readyState;1===b?g.dispatch("beforeXHR",g.xhr,a):4===b&&g.dispatch("afterXHR",g.xhr,a)}),H.allows(a,b,d)===!1?(g.dispatch("beforeXHR",g.xhr,null),g.xhr.status=405,g.reject(new Error(T.methodNotAllowed)),utility.delay(function(){g.dispatch("afterXHR",g.xhr,null)})):"get"===b&&Boolean(i)?(e&&(g.xhr.readyState=4,g.xhr.status=200,g.xhr._resheaders=i.headers),g.dispatch("beforeXHR",g.xhr,null),g.resolve(i.response),utility.delay(function(){g.dispatch("afterXHR",g.xhr,null)})):utility.delay(function(){g.xhr.open(b.toUpperCase(),a,!0),null!==d&&d.hasOwnProperty("content-type")&&(j=d["content-type"]),f&&null===j&&(j="text/plain"),null!==h&&(h.hasOwnProperty("xml")&&(h=h.xml),l&&h instanceof Document&&(h=$.decode(h)),"string"==typeof h&&regex.is_xml.test(h)&&(j="application/xml"),m&&h instanceof ArrayBuffer||o&&h instanceof Blob||h instanceof k||!(h instanceof Object)||(j="application/json",h=S.encode(h)),null===j&&(m&&h instanceof ArrayBuffer||o&&h instanceof Blob)&&(j="application/octet-stream"),null===j&&(j="application/x-www-form-urlencoded; charset=UTF-8")),(!H.ie||!f||H.version>9)&&(null===d&&(d={}),"object"==typeof i&&i.headers.hasOwnProperty("etag")&&(d.etag=i.headers.etag),null!==j&&(d["content-type"]=j),d.hasOwnProperty("callback")&&delete d.callback,d["x-requested-with"]="XMLHttpRequest",utility.iterate(d,function(a,b){null!==a&&"withCredentials"!==b&&g.xhr.setRequestHeader(b,a)}),"boolean"==typeof g.xhr.withCredentials&&null!==d&&"boolean"==typeof d.withCredentials&&(g.xhr.withCredentials=d.withCredentials)),g.on("load",function(){var c=H.ie&&void 0===g.xhr.readyState,f=!0,h=void 0,i=void 0,j=void 0,k=void 0;if(c||4!==g.xhr.readyState)c&&(i=H.parse(g.xhr,"text/plain"),F.set(a,"permission",H.bit(["get"])),F.set(a,"response",i),g.resolve(i));else switch(g.xhr.status){case 200:case 201:case 202:case 203:case 204:case 205:case 206:if(h=H.headers(g.xhr,a,b,d),"head"===b)return g.resolve(h.headers);if("options"===b)return g.resolve(h.headers);switch("delete"!==b?(e&&regex.priv.test(h.headers["cache-control"])&&(f=!1),regex.http_body.test(g.xhr.status)&&(j=h.headers["content-type"]||"",i=H.parse(g.xhr,j),void 0===i&&g.reject(new Error(T.serverError))),"get"===b&&f&&h.cachable?F.set(a,"response",h.response=utility.clone(i,!0)):F.expire(a,!0)):"delete"===b&&F.expire(a,!0),g.xhr.status){case 200:case 202:case 203:case 206:g.resolve(i);break;case 201:void 0!==h.headers.location&&!string.isEmpty(h.headers.location)||string.isUrl(i)?(k=string.trim(h.headers.Location||i),H.request(k).then(function(c){"get"===b&&f&&h.cachable&&F.set(a,"response",c),g.resolve(c)},function(a){g.reject(a)})):g.resolve(i);break;case 204:case 205:g.resolve(null)}break;case 304:g.resolve(i);break;case 401:g.reject(new Error(g.xhr.responseText||T.serverUnauthorized));break;case 403:F.set(a,"!permission",H.bit([b])),g.reject(new Error(g.xhr.responseText||T.serverForbidden));break;case 405:F.set(a,"!permission",H.bit([b])),g.reject(new Error(g.xhr.responseText||T.serverInvalidMethod));break;default:g.reject(new Error(g.xhr.responseText||T.serverError))}}),g.on("error",function(a){g.reject(a)}),g.xhr.send(null!==h?h:void 0)}),g},scroll:function(a,b){var c=Q(),d=H.scrollPos(),e=0;return b=(isNaN(b)?250:b)/100,utility.repeat(function(){var b=U.bezier(d[0],d[1],a[0],a[1],++e/100);return window.scrollTo(b[0],b[1]),100===e?(c.resolve(!0),!1):void 0},b,"scrolling"),c},scrollPos:function(){return[window.scrollX||0,window.scrollY||0]}},I={decode:function(a){var b=void 0===arguments[1]?",":arguments[1],regex=new RegExp(b+'(?=(?:[^"]|"(?:[^"])[^"]*")*$)'),c=string.trim(a).split("\n"),d=c.shift().split(b),e=void 0;return e=c.map(function(a){var b={},c=a.split(regex);return array.each(d,function(a,d){b[a]=utility.coerce((c[d]||"").replace(/^"|"$/g,""))}),b})},encode:function(a){var b=void 0===arguments[1]?",":arguments[1],c=void 0===arguments[2]?!0:arguments[2],d=S.decode(a,!0)||a,e="",f=function(a){var c=void 0;return a instanceof Array?(c='"'+a.toString()+'"',regex.object_type.test(c)&&(c='"'+I.encode(a,b)+'"')):c=a instanceof Object?'"'+I.encode(a,b)+'"':regex.csv_quote.test(a)?'"'+a.replace(/"/g,'""')+'"':a,c};return d instanceof Array?d[0]instanceof Object?(c&&(e=array.keys(d[0]).join(b)+"\n"),e+=d.map(function(a){return I.encode(a,b,!1)}).join("\n")):e+=f(d,b)+"\n":(c&&(e=array.keys(d).join(b)+"\n"),e+=array.cast(d).map(f).join(b)+"\n"),e.replace(regex.eol_nl,"")}},J=function(a){function b(a,c,d){_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.debounce=d,this.element=a,this.filters={},this.list=c,this.observer=D()}return _inherits(b,a),_createClass(b,[{key:"set",value:function(a){var b=this;return this.filters={},array.each(string.explode(a),function(a){b.filters[a]=""}),this}},{key:"teardown",value:function(){return this.observer.unhook(this.element,"keyup"),this.observer.unhook(this.element,"input"),this.element=null,this}},{key:"update",value:function(){var a=this;return utility.defer(function(){var b=R.val(a.element).toString();a.list.dispatch("beforeFilter",a.element,b),string.isEmpty(b)?a.list.filter=null:(utility.iterate(a.filters,function(c,d){var e=string.explode(b);e=e.filter(function(a){return!string.isEmpty(a)}),array.each(e,function(a,b){e[b]="^.*"+string.escape(a).replace(/(^\*|\*$)/g,"").replace(/\*/g,".*")+".*"}),a.filters[d]=e.join(",")}),a.list.filter=a.filters),a.list.pageIndex=1,a.list.refresh(),a.list.dispatch("afterFilter",a.element)},this.debounce,this.element.id+"Debounce"),this}}]),b}(E),K=function(a,b,c){var d=void 0===arguments[3]?250:arguments[3],e=[b],f=new J(a,e[0],d).set(c);return R.attr(a,"type","text"),f.observer.hook(f.element,"keyup"),f.observer.hook(f.element,"input"),f.on("keyup",f.update,"keyup"),f.on("input",f.update,"input"),f},L=function(a){function b(a,store,c){var d=void 0===arguments[3]?[]:arguments[3],e=void 0===arguments[4]?{}:arguments[4],f=void 0===arguments[5]?!1:arguments[5];_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this);var g=void 0;e.order&&!string.isEmpty(e.order)&&(g=string.explode(e.order).map(function(a){return a.replace(regex.after_space,"")})),this.element=R.create("section",{"class":"grid"},a),this.fields=c,this.filtered=f,this.list=null,this.observer=D(),this.options=e,this.store=store,this.sortable=d,this.sortOrder=g||d}return _inherits(b,a),_createClass(b,[{key:"add",value:function(a){var b=this;return this.store.set(null,a).then(null,function(a){utility.error(a),b.dispatch("error",a)}),this}},{key:"dump",value:function(){return this.store.dump(this.list.records,this.fields)}},{key:"refresh",value:function(){var a=this,b=[];return this.dispatch("beforeRefresh",this.element),this.sortOrder.length>0&&(array.each(this.sortOrder,function(c){var d=R.find(a.element,".header span[data-field='"+c+"']")[0];b.push(string.trim(c+" "+(R.data(d,"sort")||"")))}),this.options.order=this.list.order=b.join(", ")),this.list.where=null,utility.merge(this.list,this.options),this.list.refresh(),this.dispatch("afterRefresh",this.element),this}},{key:"remove",value:function(a){var b=this;return this.store.del(a).then(null,function(a){utility.error(a),b.dispatch("error",a)}),this}},{key:"sort",value:function(a){var b=utility.target(a),c=void 0;return utility.stop(a),R.hasClass(b,"sortable")&&(c=R.data(b,"field"),R.data(b,"sort","asc"===R.data(b,"sort")?"desc":"asc"),array.remove(this.sortOrder,c),this.sortOrder.splice(0,0,c),this.refresh()),this}},{key:"teardown",value:function(){return this.observer.unhook(R.find(this.element,"ul.header")[0],"click"),this.list.teardown(),R.destroy(this.element),this.element=null,this}},{key:"update",value:function(a,b){var c=this;return this.store.update(a,b).then(null,function(a){utility.error(a),c.dispatch("error",a)}),this}}]),b}(E),M=function(a,store,b,c,d,e){var f=void 0===arguments[6]?250:arguments[6],g=[store],h=new L(a,g[0],b,c,d,e),i="",j=R.create("li",{},R.create("ul",{"class":"header"},h.element)),k=100/h.fields.length+"%",l="display:inline-block;width:"+k,m=h.options.order?string.explode(h.options.order):[];return array.each(h.fields,function(a){var b=a.replace(/.*\./g,""),c=R.create("span",{innerHTML:string.capitalize(string.unCamelCase(string.unhyphenate(b,!0)).replace(/_|-/g," "),!0),style:l,"data-field":a},j);array.contains(h.sortable,a)&&(R.addClass(c,"sortable"),m.filter(function(b){return 0===b.indexOf(a)}).length>0&&R.data(c,"sort",array.contains(m,a+" desc")?"desc":"asc")),i+='<span class="'+a+'" data-field="'+a+'" style="'+l+'">{{'+a+"}}</span>"}),h.sortable.length>0&&h.observer.hook(j.parentNode,"click",h.sort,"sort",h),h.filtered===!0&&(h.options.listFiltered=!0,h.options.listFilter=h.fields.join(",")),h.options.debounce=f,g.push(O.factory(h.element,g[0],i,h.options)),h.list=g[1],h.on("beforeRefresh",function(a){R.dispatch(a,"beforeRefresh")},"bubble"),h.on("afterRefresh",function(a){R.dispatch(a,"afterRefresh")},"bubble"),h.on("click",function(a){R.hasClass(a.currentTarget,"header")&&h.sort(a)},"header"),h.list.on("change",function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];h.dispatch.apply(h,["change"].concat(b))},"change"),h.list.on("beforeFilter",function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];h.dispatch.apply(h,["beforeFilter"].concat(b))},"beforeFilter"),h.list.on("afterFilter",function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];h.dispatch.apply(h,["afterFilter"].concat(b))},"afterFilter"),h},N=function(a){function b(a,store,c){_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.callback=null,this.current=[],this.element=a,this.emptyMsg=T.noData,this.filter=null,this.filtered=[],this.id=utility.genId(),this.items=[],this.listFilter=null,this.mutation=null,this.observer=D(),this.pageIndex=1,this.pageSize=null,this.pageRange=5,this.pagination="bottom",this.placeholder="",this.order="",this.records=[],this.template=c,this.total=0,this.store=store,this.where=null}return _inherits(b,a),_createClass(b,[{key:"add",value:function(a){var b=this;return this.store.set(null,a).then(null,function(a){utility.error(a),b.dispatch("error",a)}),this}},{key:"dump",value:function(){return this.store.dump(this.records)}},{key:"page",value:function(a){return this.pageIndex=a,this.refresh()}},{key:"pages",value:function(){var a=this,b=this.element,c=this.pageIndex,d=this.pagination,e=this.pageRange,f=Math.floor(e/2),g=c-f,h=c+f,i=O.pages(this),j=void 0;return array.each(utility.dom("#"+b.id+"-pages-top, #"+b.id+"-pages-bottom"),function(b){b&&(a.observer.unhook(b,"click"),R.destroy(b))}),this.filter&&0===this.filtered.length||0===this.total||1===i?this:(1>g&&(j=V.diff(g,1),g+=j,h+=j),h>i&&(h=i,g=h-e+1,1>g&&(g=1)),V.diff(g,h)>=e&&--h,array.each(string.explode(d),function(d){var e=!1,f=c>1,j=i>=c+1,k=c>=i,l=void 0,m=void 0;for(l=R.create("ul",{"class":"list pages hidden "+d,id:b.id+"-pages-"+d},b,"bottom"===d?"after":"before"),R.create(f?"a":"span",{"class":"first page","data-page":1,innerHTML:"&lt;&lt;"},R.create("li",{},l)),R.create(f?"a":"span",{"class":"prev page","data-page":c-1,innerHTML:"&lt;"},R.create("li",{},l)),m=g-1;++m<=h;)e=m===c,R.create(e?"span":"a",{"class":e?"current page":"page","data-page":m,innerHTML:m},R.create("li",{},l));R.create(j?"a":"span",{"class":"next page","data-page":j?c+1:null,innerHTML:"&gt;"},R.create("li",{},l)),R.create(k?"span":"a",{"class":"last page","data-page":k?null:i,innerHTML:"&gt;&gt;"},R.create("li",{},l)),R.removeClass(l,"hidden"),a.observer.hook(l,"click")}),this)}},{key:"refresh",value:function(){var a=this,b=void 0===arguments[0]?!1:arguments[0],c=this.element,d="object"==typeof this.template,e=null!==this.filter,f=[],g="function"==typeof this.callback,h=new RegExp,i=[],j=[],k=void 0,l=void 0,m=void 0;return this.dispatch("beforeRefresh",c),k=d?function(b){var c=S.encode(a.template),d=array.unique(c.match(/\{\{[\w\.\-\[\]]+\}\}/g));

		return c=c.replace("{{"+a.store.key+"}}",b.key),array.each(d,function(a){var d=a.replace(/\{\{|\}\}/g,""),e=utility.walk(b.data,d)||"";h.compile(string.escape(a),"g"),c=c.replace(h,S.encode(e).replace(/(^")|("$)/g,""))}),c=S.decode(c.replace(/\{\{.*\}\}/g,a.placeholder)),{li:c}}:function(b){var c=a.template,d=array.unique(c.match(/\{\{[\w\.\-\[\]]+\}\}/g));return c=c.replace("{{"+a.store.key+"}}",b.key),array.each(d,function(a){var d=a.replace(/\{\{|\}\}/g,""),e=utility.walk(b.data,d);void 0===e&&(e=""),h.compile(string.escape(a),"g"),c=c.replace(h,e)}),c=c.replace(/\{\{.*\}\}/g,a.placeholder),'<li data-key="'+b.key+'">'+c+"</li>"},m=function(b){if(a.records=b,a.total=a.records.length,a.filtered=[],a.current=[],e&&array.each(a.records,function(b){utility.iterate(a.filter,function(c,d){var e=void 0;return array.contains(i,b.key)?!1:(e=d===a.store.key,void array.each(string.explode(c),function(c){var f=new RegExp(c,"i"),g=e?"":utility.walk(b.data,d);return e&&f.test(b.key)||f.test(g)?(i.push(b.key),a.filtered.push(b),!1):void 0}))})}),null===a.pageSize||isNaN(a.pageIndex)||isNaN(a.pageSize))a.current=e?a.filtered:a.records;else{if(l=O.pages(a),l>0&&a.pageIndex>l)return a.page(l);a.total>0&&(j=O.range(a),a.current=array.limit(e?a.filtered:a.records,j[0],j[1]))}array.each(a.current,function(a){var b=k(a),c=p(b);f.push({key:a.key,template:b,hash:c})}),utility.render(function(){var b=[],d=[],e=void 0,h=void 0;if(0===f.length)R.html(c,'<li class="empty">'+a.emptyMsg+"</li>");else if(0===a.items.length)R.html(c,f.map(function(a){return a.template}).join("")),g&&array.each(array.cast(c.childNodes),function(b){a.callback(b)});else{if(array.each(f,function(b,e){void 0!==a.items[e]&&a.items[e].hash!==b.hash?(R.data(R.html(c.childNodes[e],b.template.replace(/<li data-key=\"\d+\">|<\/li>/g,"")),"key",b.key),d.push(e)):void 0===a.items[e]&&(R.create(b.template,null,c),d.push(e))}),f.length<a.items.length){for(e=f.length-1,h=a.items.length;++e<h;)b.push(e);array.each(b.reverse(),function(a){R.destroy(c.childNodes[a])})}g&&array.each(d,function(b){a.callback(c.childNodes[b])})}a.items=f,null===a.pageSize||!regex.top_bottom.test(a.pagination)||isNaN(a.pageIndex)||isNaN(a.pageSize)?array.each(utility.$("#"+c.id+"-pages-top, #"+c.id+"-pages-bottom"),function(a){R.destroy(a)}):a.pages(),a.dispatch("afterRefresh",c)})},null===this.where?string.isEmpty(this.order)?m(this.store.get()):this.store.sort(this.order,b).then(m,function(b){utility.error(b),a.dispatch("error",b)}):string.isEmpty(this.order)?this.store.select(this.where).then(m,function(b){utility.error(b),a.dispatch("error",b)}):this.store.sort(this.order,b,this.where).then(m,function(b){utility.error(b),a.dispatch("error",b)}),this}},{key:"remove",value:function(a){var b=this;return this.store.del(a).then(null,function(a){utility.error(a),b.dispatch("error",a)}),this}},{key:"sort",value:function(a){return this.order=a,this.refresh()}},{key:"teardown",value:function(){var a=this,b=void 0===arguments[0]?!1:arguments[0],c=this.element,d=c.id;return array.each(this.store.lists,function(b,c){return b.id===a.id?(array.remove(a.store.lists,c),!1):void 0}),this.listFilter&&this.listFilter.teardown(),array.each(utility.$("#"+d+"-pages-top, #"+d+"-pages-bottom"),function(c){a.observer.unhook(c,"click"),b&&R.destroy(c)}),this.observer.unhook(c,"click"),b&&R.destroy(c),this.element=null,this}},{key:"update",value:function(a,b){var c=this;return this.store.update(a,b).then(null,function(a){utility.error(a),c.dispatch("error",a)}),this}}]),b}(E),O={factory:function(a,store,b,c){var d=[store],e=new N(R.create("ul",{"class":"list",id:utility.genId(null,!0)},a),d[0],b);return c instanceof Object&&(c.listFiltered&&c.listFilter&&(e.listFilter=K(R.create("input",{id:e.element.id+"-filter","class":"filter",placeholder:"Filter"},a,"first"),e,c.listFilter,c.debounce),delete c.listFilter,delete c.listFiltered,delete c.debounce),utility.merge(e,c)),e.store.lists.push(e),e.on("beforeRefresh",function(a){R.dispatch(a,"beforeRefresh")},"bubble"),e.on("afterRefresh",function(a){R.dispatch(a,"afterRefresh")},"bubble"),e.on("change",function(a){R.dispatch(e.element,"change",a)},"change"),e.on("click",function(a){var b=utility.target(a),c=void 0;utility.stop(a),"A"===b.nodeName&&(c=R.data(b,"page"),isNaN(c)||e.page(c))},"pagination"),f&&(e.mutation=new MutationObserver(function(a){e.dispatch("change",a)}),e.mutation.observe(e.element,{childList:!0,subtree:!0})),(null===e.store.uri||e.store.loaded)&&e.refresh(),e},pages:function(a){if(isNaN(a.pageSize))throw new Error(T.invalidArguments);return Math.ceil((a.filter?a.filtered.length:a.total)/a.pageSize)},range:function(a){var b=a.pageIndex*a.pageSize-a.pageSize,c=a.pageSize;return[b,c]}},P=function(){function a(){var b=this;_classCallCheck(this,a),this.promise=W.factory(),this.onDone=[],this.onAlways=[],this.onFail=[],this.promise.then(function(a){array.each(b.onDone,function(b){b(a)}),array.each(b.onAlways,function(b){b(a)}),b.onAlways=[],b.onDone=[],b.onFail=[]},function(a){array.each(b.onFail,function(b){b(a)}),array.each(b.onAlways,function(b){b(a)}),b.onAlways=[],b.onDone=[],b.onFail=[]})}return _createClass(a,[{key:"always",value:function(a){return this.onAlways.push(a),this}},{key:"catch",value:function(a){return this.promise["catch"](a)}},{key:"done",value:function(a){return this.onDone.push(a),this}},{key:"fail",value:function(a){return this.onFail.push(a),this}},{key:"reject",value:function(a){return this.promise.reject.call(this.promise,a),this}},{key:"resolve",value:function(a){return this.promise.resolve.call(this.promise,a),this}},{key:"then",value:function(a,b){return this.promise.then(a,b)}}]),a}(),Q=function(){return new P},R={addClass:function(a,b){R.klass(a,b,!0)},appendTo:function(a,b){return a.appendChild(b),a},attr:function(a,b,c){var d=void 0,e=void 0;if(regex.svg.test(a.namespaceURI)){if(void 0===c)return e=a.getAttributeNS(a.namespaceURI,b),e=null===e||string.isEmpty(e)?void 0:utility.coerce(e);a.setAttributeNS(a.namespaceURI,b,c)}else{if("string"==typeof c&&(c=string.trim(c)),regex.checked_disabled.test(b)&&void 0===c)return utility.coerce(a[b]);if(regex.checked_disabled.test(b)&&void 0!==c)a[b]=c;else{if("SELECT"===a.nodeName&&"selected"===b&&void 0===c)return utility.dom("#"+a.id+' option[selected="selected"]')[0]||utility.dom("#"+a.id+" option")[0];if("SELECT"===a.nodeName&&"selected"===b&&void 0!==c)d=utility.dom("#"+a.id+' option[selected="selected"]')[0],void 0!==d&&(d.selected=!1,d.removeAttribute("selected")),d=utility.dom("#"+a.id+' option[value="'+c+'"]')[0],d.selected=!0,d.setAttribute("selected","selected");else{if(void 0===c)return e=a.getAttribute(b),e=null===e||string.isEmpty(e)?void 0:utility.coerce(e);a.setAttribute(b,c)}}}return a},clear:function(a){return"function"==typeof a.reset?a.reset():void 0!==a.value?R.update(a,{innerHTML:"",value:""}):R.update(a,{innerHTML:""}),a},create:function(a,c,d,e){var f=!1,g=!1,h=void 0,i=void 0;return a=a.replace(/\t|\n|\r/g,""),d?f=d.namespaceURI&&regex.svg.test(d.namespaceURI):d=b.body,regex.html.test(a)?(g=!0,h=R.frag(a),i=1===h.childNodes.length?h.childNodes[0]:array.cast(h.childNodes)):(h=f||regex.svg.test(a)?b.createElementNS("http://www.w3.org/2000/svg",a):b.createElement(a),c instanceof Object&&R.update(h,c)),e&&"last"!==e?"first"===e?R.prependChild(d,h):"after"===e?(e={after:d},d=d.parentNode,d.insertBefore(h,e.after.nextSibling)):e.after?d.insertBefore(h,e.after.nextSibling):"before"===e?(e={before:d},d=d.parentNode,d.insertBefore(h,e.before)):e.before?d.insertBefore(h,e.before):d.appendChild(h):d.appendChild(h),g?i:h},css:function(a,b,c){return regex.caps.test(b)||(b=string.toCamelCase(b)),void 0!==c?(a.style[b]=c,a):a.style[b]},data:function(a,b,c){return void 0!==c?(a.setAttribute("data-"+b,regex.json_wrap.test(c)?S.encode(c):c),a):utility.coerce(a.getAttribute("data-"+b))},destroy:function(a){return void(null!==a.parentNode&&a.parentNode.removeChild(a))},disable:function(a){return"boolean"!=typeof a.disabled||a.disabled||(a.disabled=!0),a},dispatch:function(a,c){var d=void 0===arguments[2]?{}:arguments[2],e=void 0===arguments[3]?!0:arguments[3],f=void 0===arguments[4]?!0:arguments[4],g=void 0;if(a){try{g=new CustomEvent(c)}catch(h){g=b.createEvent("CustomEvent")}return g.initCustomEvent(c,e,f,d),a.dispatchEvent(g),a}},enable:function(a){return"boolean"==typeof a.disabled&&a.disabled&&(a.disabled=!1),a},find:function(a,b){var c=[];return array.each(string.explode(b),function(b){c=c.concat(array.cast(a.querySelectorAll(b)))}),c},frag:function(a){var c=b.createDocumentFragment();return a&&(array.each(array.cast(R.create("div",{innerHTML:a},c).childNodes),function(a){c.appendChild(a)}),c.removeChild(c.childNodes[0])),c},has:function(a,b){var c=R.find(a,b);return!isNaN(c.length)&&c.length>0},hasClass:function(a,b){return a.classList.contains(b)},hidden:function(a){return"none"===a.style.display||a.hidden===!0},html:function(a,b){return void 0===b?a.innerHTML:(a.innerHTML=b,a)},is:function(a,b){return regex.selector_is.test(b)?1===R.find(a.parentNode,a.nodeName.toLowerCase()+b).filter(function(b){return b.id===a.id}).length:new RegExp(b,"i").test(a.nodeName)},klass:function(a,b){var c=void 0===arguments[2]?!0:arguments[2];return b=string.explode(b," "),c?array.each(b,function(b){a.classList.add(b)}):array.each(b,function(b){return"*"===b?(array.each(a.classList,function(b){a.classList.remove(b)}),!1):void a.classList.remove(b)}),a},position:function(){var a=void 0===arguments[0]?b.body:arguments[0],c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;if(c=d=0,h=a.offsetWidth,g=a.offsetHeight,a.offsetParent){for(d=a.offsetTop,c=a.offsetLeft;a=a.offsetParent;)c+=a.offsetLeft,d+=a.offsetTop;e=b.body.offsetWidth-(c+h),f=b.body.offsetHeight-(d+g)}else e=h,f=g;return[c,d,e,f]},prependChild:function(a,b){return 0===a.childNodes.length?a.appendChild(b):a.insertBefore(b,a.childNodes[0])},removeAttr:function(a,b){return regex.svg.test(a.namespaceURI)?a.removeAttributeNS(a.namespaceURI,b):"SELECT"===a.nodeName&&"selected"===b?array.each(R.find(a,"option"),function(a){return a.selected===!0?(a.selected=!1,a.removeAttribute("selected"),!1):void 0}):a.removeAttribute(b),a},removeClass:function(a,b){R.klass(a,b,!1)},scrollTo:function(a,b,c,d){var e=array.remove(R.position(a),2,3);return isNaN(c)||(e[0]+=c),isNaN(d)||(e[1]+=d),H.scroll(e,b)},serialize:function(a){var string=void 0===arguments[1]?!0:arguments[1],b=void 0===arguments[2]?!0:arguments[2],c={},d=void 0,e=void 0;return d="FORM"===a.nodeName?a.elements?array.cast(a.elements):a.find("button, input, select, textarea"):[a],array.each(d,function(a){var b=a.id||a.name||a.type;"FORM"===a.nodeName?utility.merge(c,S.decode(R.serialize(a))):c[b]||(c[b]=R.val(a))}),string?(e="",utility.iterate(c,function(a,c){e+=b?"&"+encodeURIComponent(c)+"="+encodeURIComponent(a):"&"+c+"="+a}),e=e.replace(regex.and,"?")):e=c,e},size:function(a){return[a.offsetWidth+V.parse(a.style.paddingLeft||0)+V.parse(a.style.paddingRight||0)+V.parse(a.style.borderLeft||0)+V.parse(a.style.borderRight||0),a.offsetHeight+V.parse(a.style.paddingTop||0)+V.parse(a.style.paddingBottom||0)+V.parse(a.style.borderTop||0)+V.parse(a.style.borderBottom||0)]},text:function(a,b){var c=a.textContent?"textContent":"innerText",d={},e=!1;return"undefined"!=typeof b&&(e=!0,d[c]=b),e?R.update(a,d):a[c]},toggleClass:function(a,b){return a.classList.toggle(b),a},update:function(a,b){return utility.iterate(b,function(b,c){regex.element_update.test(c)?a[c]=b:"class"===c?string.isEmpty(b)?R.removeClass(a,"*"):R.addClass(a,b):0===c.indexOf("data-")?R.data(a,c.replace("data-",""),b):R.attr(a,c,b)}),a},val:function(a,b){var c="input",d=void 0;if(void 0===b){if(regex.radio_checkbox.test(a.type)){if(string.isEmpty(a.name))throw new Error(T.expectedProperty);array.each(utility.dom("input[name='"+a.name+"']"),function(a){return a.checked?(d=a.value,!1):void 0})}else regex.select.test(a.type)?(d=null,array.each(R.find(a,"option"),function(a){return a.selected===!0?(d=a.value,!1):void 0})):d=a.value?a.value:a.placeholder?a.placeholder===a.innerText?void 0:a.innerText:R.text(a);void 0!==d?(d=utility.coerce(d),"string"==typeof d&&(d=string.trim(d))):d=""}else b=b.toString(),regex.radio_checkbox.test(a.type)?(c="click",array.each(utility.dom("input[name='"+a.name+"']"),function(a){return a.value===b?(a.checked=!0,d=a,!1):void 0})):regex.select.test(a.type)?(c="change",array.each(R.find(a," option"),function(a){return a.value===b?(a.selected=!0,d=a,!1):void 0})):void 0!==a.value?a.value=b:R.text(a,b),R.dispatch(a,c),d=a;return d}},S={decode:function(a,b){try{return JSON.parse(a)}catch(c){return void(b!==!0&&utility.error(c,[a,b]))}},encode:function(a,b){try{return JSON.stringify(a)}catch(c){return void(b!==!0&&utility.error(c,[a,b]))}}},T={expectedNumber:"Expected a Number",expectedProperty:"Expected a property, and it was not set",expectedObject:"Expected an Object",invalidArguments:"One or more arguments is invalid",invalidStateNoHeaders:"INVALID_STATE_ERR: Headers have not been received",invalidStateNoSync:"Synchronous XMLHttpRequest requests are not supported",invalidStateNotOpen:"INVALID_STATE_ERR: Object is not open",invalidStateNotSending:"INVALID_STATE_ERR: Object is sending",invalidStateNotUsable:"INVALID_STATE_ERR: Object is not usable",methodNotAllowed:"Method not allowed",noData:"Nothing to display",notAvailable:"Requested method is not available",datastoreNoPrevVersion:"No previous version found",requestTimeout:"Request timed out",serverError:"Server error has occurred",serverForbidden:"Forbidden to access URI",serverInvalidMethod:"Method not allowed",serverUnauthorized:"Authorization required to access URI",upgrade:"Your browser is too old to use keigai, please upgrade"},U={bezier:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var d=array.cast(b),e=d.pop(),f=array.chunk(d,2),g=f.length,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0;if(2>g||g>4)throw new Error(T.invalidArguments);return h=[],i=1-e,j=U.sqr(i),k=2*i*e,l=U.sqr(e),m=Math.pow(i,3),n=3*j*e,o=3*i*l,p=Math.pow(e,3),2===g?(h.push(i*f[0][0]+e*f[1][0]),h.push(i*f[0][1]+e*f[1][1])):3===g?(h.push(j*f[0][0]+k*f[1][0]+(l+f[2][0])),h.push(j*f[0][1]+k*f[1][1]+(l+f[2][1]))):4===g&&(h.push(m*f[0][0]+n*f[1][0]+o*f[2][0]+p*f[3][0]),h.push(m*f[0][1]+n*f[1][1]+o*f[2][1]+p*f[3][1])),h},dist:function(a,b){return Math.sqrt(U.sqr(b[0]-a[0])+U.sqr(b[1]-a[1]))},sqr:function(a){return a*a}},V={diff:function(a,b){return Math.abs(a-b)},even:function(a){return a%2===0},format:function(a){var b=void 0===arguments[1]?",":arguments[1],c=void 0===arguments[2]?3:arguments[2];a=a.toString();for(var d=a.indexOf(".")>-1?"."+a.replace(regex.number_format_1,""):"",e=a.replace(regex.number_format_2,"").split("").reverse(),f=Math.floor(e.length/c),g=1,h=-1,i=void 0;++h<f;)i=1===g?c:c*g+(2===g?1:g-1),e.splice(i,0,b),g++;return e=e.reverse().join(""),e.charAt(0)===b&&(e=e.substring(1)),e+d},half:function(a,b){return b?a/b===.5:a/2},odd:function(a){return!V.even(a)},parse:function(a,b){return void 0===b?parseFloat(a):parseInt(a,b)},random:function(){var a=void 0===arguments[0]?100:arguments[0];return Math.floor(Math.random()*(a+1))},round:function(a,b){return a=V.parse(a),void 0===b||string.isEmpty(b)?V.parse(a.toFixed(0)):regex.down.test(b)?~~a:Math.ceil(a)}},W={factory:function(){var a=void 0,b=void 0,c=void 0,d=void 0,e=void 0;return a=new l(function(a,b){c=a,d=b}),b=function(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return a["catch"].apply(a,c)},e=function(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return a.then.apply(a,c)},{"catch":b,resolve:c,reject:d,then:e}}},X=function(a){function b(){_classCallCheck(this,b),_get(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.autosave=!1,this.callback=null,this.credentials=null,this.lists=[],this.events=!0,this.expires=null,this.headers={Accept:"application/json"},this.ignore=[],this.index=[],this.indexes={key:{}},this.key=null,this.loaded=!1,this.mongodb="",this.observer=D(),this.records=[],this.source=null,this.total=0,this.versions={},this.versioning=!0,this.views={},this.uri=null}return _inherits(b,a),_createClass(b,[{key:"batch",value:function(a,b){var c=this,d=void 0===arguments[2]?!1:arguments[2],e=this.events,f=Q(),g=[];return!regex.set_del.test(a)||d&&regex.del.test(a)||"object"!=typeof b?f.reject(new Error(T.invalidArguments)):(e&&this.dispatch("beforeBatch",b),d&&this.clear(d),0===b.length?(this.loaded=!0,e&&this.dispatch("afterBatch",this.records),f.resolve(this.records)):("del"===a?array.each(b,function(a){g.push(c.del(a,!1,!0))}):array.each(b,function(a){g.push(c.set(a[c.key]||null,a,!0))}),this.loaded=!1,utility.when(g).then(function(b){c.loaded=!0,e&&c.dispatch("afterBatch",b),array.each(c.lists,function(a){a.refresh(!0)}),"del"===a&&(c.records=array.compact(c.records),c.reindex()),c.autosave&&c.save(),f.resolve(b)},function(a){e&&c.dispatch("failedBatch",a),f.reject(a)}))),f}},{key:"buildUri",value:function(a){var b=utility.parse(this.uri);return b.protocol+"//"+b.host+b.pathname.replace(regex.endslash,"")+"/"+a}},{key:"clear",value:function(){var a=void 0===arguments[0]?!0:arguments[0],b=this.events===!0,c=this.autosave===!0;return a?(this.indexes={key:{}},this.loaded=!1,this.records=[],this.total=0,this.views={},array.each(this.lists,function(a){a&&a.refresh()})):(b&&this.dispatch("beforeClear"),array.each(this.lists,function(a){a&&a.teardown(!0)}),this.autosave=!1,this.callback=null,this.credentials=null,this.lists=[],this.events=!0,this.expires=null,this.headers={Accept:"application/json"},this.ignore=[],this.index=[],this.indexes={key:{}},this.key=null,this.loaded=!1,this.records=[],this.source=null,this.total=0,this.versions={},this.versioning=!0,this.views={},this.uri=null,b&&this.dispatch("afterClear")),c&&this.save(),this}},{key:"del",value:function(a){var b=this,c=void 0===arguments[1]?!0:arguments[1],d=void 0===arguments[2]?!1:arguments[2];a=a.key?a:this.get(a);var e=Q();return void 0===a?e.reject(new Error(T.invalidArguments)):(this.events&&this.dispatch("beforeDelete",a),null===this.uri||null!==this.callback?this.delComplete(a,c,d,e):H.request(this.buildUri(a.key),"DELETE",null,utility.merge({withCredentials:this.credentials},this.headers)).then(function(){b.delComplete(a,c,d,e)},function(a){b.dispatch("failedDelete",a),e.reject(a)})),e}},{key:"delComplete",value:function(a,b,c,d){var e=this;return delete this.indexes.key[a.key],delete this.versions[a.key],this.total--,this.views={},c?this.records[a.index]=null:(array.remove(this.records,a.index),b?this.reindex():array.each(a.indexes,function(b){array.remove(e.indexes[b[0]][b[1]],a.index),0===e.indexes[b[0]][b[1]].length&&delete e.indexes[b[0]][b[1]]}),this.autosave&&this.purge(a.key),this.events&&this.dispatch("afterDelete",a),array.each(this.lists,function(a){a.refresh()})),void 0!==d?d.resolve(a.key):a.key}},{key:"dump",value:function(a,b){var c=this;a=a||this.records;var d=b instanceof Array&&b.length>0,e=null!==this.key,f=void 0;return f=d?function(a){var d={};return array.each(b,function(b){d[b]=b===c.key?isNaN(a.key)?a.key:Number(a.key):utility.clone(a.data[b],!0)}),d}:function(a){var b={};return e&&(b[c.key]=isNaN(a.key)?a.key:Number(a.key)),utility.iterate(a.data,function(a,c){b[c]=utility.clone(a,!0)}),b},a.map(f)}},{key:"get",value:function(a,b){var c=this,d=typeof a,e=void 0;return"undefined"===d?e=this.records:"string"===d?e=-1===a.indexOf(",")?this.records[this.indexes.key[a]]:string.explode(a).map(function(a){return isNaN(a)?c.records[c.indexes.key[a]]:c.records[parseInt(a,10)]}):"number"===d&&(e=isNaN(b)?this.records[parseInt(a,10)]:array.limit(this.records,parseInt(a,10),parseInt(b,10))),utility.clone(e,!0)}},{key:"join",value:function(a){function b(b,c){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a,b){var c=this,d=void 0===arguments[2]?"inner":arguments[2],e=Q(),f=[],g=[],h=b===this.key,i=array.merge(array.keys(this.records[0].data),array.keys(a.records[0].data)),j=void 0;return"inner"===d?j=function(c){var d={},e=c.data,i=Q();d[b]=h?c.key:e[b],a.select(d).then(function(a){a.length>2?i.reject(new Error(T.databaseMoreThanOne)):1===a.length?(f.push(utility.merge(e,a[0].data)),i.resolve(!0)):i.resolve(!1)}),g.push(i)}:"left"===d?j=function(c){var d={},e=c.data,j=Q();d[b]=h?c.key:e[b],a.select(d).then(function(a){a.length>2?j.reject(new Error(T.databaseMoreThanOne)):1===a.length?(f.push(utility.merge(e,a[0].data)),j.resolve(!0)):(array.each(i,function(a){void 0===e[a]&&(e[a]=null)}),f.push(e),j.resolve(!0))}),g.push(j)}:"right"===d&&(j=function(a){var d={},e=a.data,j=Q();d[b]=h?a.key:e[b],c.select(d).then(function(a){a.length>2?j.reject(new Error(T.databaseMoreThanOne)):1===a.length?(f.push(utility.merge(e,a[0].data)),j.resolve(!0)):(array.each(i,function(a){void 0===e[a]&&(e[a]=null)}),f.push(e),j.resolve(!0))}),g.push(j)}),array.each(utility.clone("right"===d?a.records:this.records,!0),j),utility.when(g).then(function(){e.resolve(f)},function(a){e.reject(a)}),e})},{key:"only",value:function(a){return this.records.map(a===this.key?function(a){return a.key}:function(b){return b.data[a]})}},{key:"purge",value:function(a){return this.storage(a||this,"remove")}},{key:"reindex",value:function(){var a=this,b=-1,c=[];return this.views={},this.indexes={key:{}},this.total>0&&array.each(this.records,function(d){void 0!==d&&(c[++b]=d,d.index=b,a.indexes.key[d.key]=b,a.setIndexes(d))}),this.records=c,this}},{key:"restore",value:function(a){return this.storage(a||this,"get")}},{key:"save",value:function(a){return this.storage(a||this,"set")}},{key:"select",value:function(a){var b=this,c=Q(),d=[],e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0;if(a instanceof Object)if(utility.iterate(a,function(a,c){"function"==typeof a&&(b[c]=a.toString(),d.push(c))}),q)try{k=utility.worker(c),k.postMessage({cmd:"select",indexes:this.indexes,records:this.records,where:S.encode(a),functions:d})}catch(l){q=!1,this.select(a).then(function(a){c.resolve(a)},function(a){c.reject(a)})}else e=array.fromObject(a),i=array.flat(e).filter(function(a,b){return b%2===0}).map(function(a){return a.toString()}).sort(array.sort),g=i.join("|"),j=i.map(function(b){return a[b]}).join("|"),f="return ( ",0===d.length&&this.indexes[g]?h=(this.indexes[g][j]||[]).map(function(a){return b.records[a]}):(e.length>1?array.each(e,function(a,b){var c="( ";b>0&&(c=" && ( "),f+=a[1]instanceof Function?c+a[1].toString()+'( rec.data["'+a[0]+'"] ) )':isNaN(a[1])?c+'rec.data["'+a[0]+'"] === "'+a[1]+'" )':c+'rec.data["'+a[0]+'"] === '+a[1]+" )"}):f+=e[0][1]instanceof Function?e[0][1].toString()+'( rec.data["'+e[0][0]+'"] )':isNaN(e[0][1])?'rec.data["'+e[0][0]+'"] === "'+e[0][1]+'"':'rec.data["'+e[0][0]+'"] === '+e[0][1],f+=" );",h=utility.clone(this.records,!0).filter(new Function("rec",f))),c.resolve(h);else c.reject(new Error(T.invalidArguments));return c}},{key:"set",value:function(a,b){var c=this,d=void 0===arguments[2]?!1:arguments[2],e=void 0===arguments[3]?!1:arguments[3];b=utility.clone(b,!0);var f=this.events,g=Q(),h=null!==a?this.get(a)||null:b[this.key]?this.get(b[this.key])||null:null,i="POST",j=utility.parse(this.uri||""),k=void 0,l=void 0,m=void 0,n=function(a,b,d){var e=[];return a&&array.each(array.keys(d),function(a){a!==c.key&&void 0===b[a]&&e.push({op:"remove",path:"/"+a})}),utility.iterate(b,function(a,b){b!==c.key&&void 0===d[b]?e.push({op:"add",path:"/"+b,value:a}):S.encode(d[b])!==S.encode(a)&&e.push({op:"replace",path:"/"+b,value:a})}),e};return"string"==typeof b?(k=-1===b.indexOf("//")?"/"!==b.charAt(0)?this.buildUri(b):null!==this.uri&&regex.root.test(b)?j.protocol+"//"+j.host+b:b:b,a=k.replace(regex.not_endpoint,""),string.isEmpty(a)?g.reject(new Error(T.invalidArguments)):(!d&&f&&this.dispatch("beforeSet",{key:a,data:b}),H.request(k,"GET",null,utility.merge({withCredentials:this.credentials},this.headers)).then(function(b){c.setComplete(h,a,c.source?utility.walk(b,c.source):b,d,e,g)},function(a){c.dispatch("failedSet",a),g.reject(a)}))):(!d&&f&&this.dispatch("beforeSet",{key:a,data:b}),d||null===this.uri?this.setComplete(h,a,b,d,e,g):(null!==a?(k=this.buildUri(a),i="PATCH",l=utility.clone(b,!0),b=n(e,b,this.dump([h])[0])):k=j.protocol+"//"+j.host+j.pathname,m=H.request(k,i,b,utility.merge({withCredentials:this.credentials},this.headers)),m.then(function(b){var f=void 0;f=204!==m.xhr.status&&m.xhr.status<300&&null===a?c.source?utility.walk(b,c.source):b:l,c.setComplete(h,a,f,d,e,g)},function(f){"PATCH"===i?(i="PUT",b=utility.clone(l,!0),utility.iterate(h.data,function(a,c){b[c]=a}),H.request(k,i,b,utility.merge({withCredentials:c.credentials},c.headers)).then(function(){c.setComplete(h,a,l,d,e,g)},function(a){c.dispatch("failedSet",a),g.reject(a)})):(c.dispatch("failedSet",f),g.reject(f))}))),g}},{key:"setComplete",value:function(a,b,c,d,e,f){return this.views={},null===b&&(b=null!==this.key&&void 0!==c[this.key]&&null!==c[this.key]?c[this.key].toString():utility.uuid()),this.key&&delete c[this.key],null===a?(a={index:this.total++,key:b,data:c,indexes:[]},this.indexes.key[b]=a.index,this.records[a.index]=a,this.versioning&&(this.versions[a.key]=B.factory(h),this.versions[a.key].nth=0)):(this.versioning&&(void 0===this.versions[a.key]&&(this.versions[a.key]=B.factory(h),this.versions[a.key].nth=0),this.versions[a.key].set("v"+ ++this.versions[a.key].nth,this.dump([a])[0])),a=this.records[a.index],e&&(a.data={}),utility.iterate(c,function(b,c){a.data[c]=b}),a=utility.clone(a,!0)),this.setIndexes(a),d||(this.autosave&&this.save(),this.events&&this.dispatch("afterSet",a),array.each(this.lists,function(a){a.refresh()})),void 0!==f&&f.resolve(a),this}},{key:"setExpires",value:function(a){var b=this,c=this.id+"Expire",d=a;if(null!==a&&null===this.uri||null!==a&&(isNaN(a)||1e3>a))throw new Error(T.invalidArguments);this.expires!==a&&(this.expires=a,utility.clearTimers(c),null!==a&&utility.repeat(function(){return null===b.uri?(b.setExpires(null),!1):(b.dispatch("beforeExpire"),F.expire(b.uri),b.dispatch("expire"),void b.dispatch("afterExpire"))},d,c,!1))}},{key:"setIndexes",value:function(a){var b=this,c="|";return a.indexes=[],array.each(this.index,function(d){var e=d.split(c),f="";void 0===b.indexes[d]&&(b.indexes[d]={}),array.each(e,function(b,d){f+=(d>0?c:"")+a.data[b]}),void 0===b.indexes[d][f]&&(b.indexes[d][f]=[]),array.contains(b.indexes[d][f],a.index)||(b.indexes[d][f].push(a.index),a.indexes.push([d,f]))}),this}},{key:"setUri",value:function(a){var b=this,c=Q(),d=void 0;return null!==a&&string.isEmpty(a)&&c.reject(new Error(T.invalidArguments)),null===a?this.uri=a:(d=utility.parse(a),this.uri=d.protocol+"//"+d.host+d.path,string.isEmpty(d.auth)||this.headers.authorization||this.headers.Authorization||(this.headers.Authorization="Basic "+p(decodeURIComponent(d.auth))),this.on("expire",function(){b.sync()},"resync"),F.expire(this.uri),this.sync().then(function(a){c.resolve(a)},function(a){c.reject(a)})),c}},{key:"sort",value:function(a,b,c){var d=this;b=b===!0||c instanceof Object;var e=string.toCamelCase(string.explode(a).join(" ")),f=Q(),g=function(c){var g=void 0;if(0===d.total)f.resolve([]);else if(!b&&d.views[e])f.resolve(d.views[e]);else if(q){f.then(function(a){return d.views[e]=a,d.views[e]},function(a){utility.error(a)});try{g=utility.worker(f),g.postMessage({cmd:"sort",indexes:d.indexes,records:c,query:a})}catch(h){q=!1,d.views[e]=array.keySort(c,a,"data"),f.resolve(d.views[e])}}else d.views[e]=array.keySort(c,a,"data"),f.resolve(d.views[e])};return c?this.select(c).then(g,function(a){f.reject(a)}):g(utility.clone(this.records,!0)),f}},{key:"storage",value:function(a,b,c){var d=this,e=this,f=!1,g=!string.isEmpty(this.mongodb),h="session"===c&&"undefined"!=typeof sessionStorage,i=Q(),j=void 0,k=void 0,l=void 0;return regex.number_string_object.test(typeof a)&&regex.get_remove_set.test(b)?(f=regex.number_string.test(typeof a)||a.hasOwnProperty("data"),"remove"!==b?(!f||a instanceof Object||(a=this.get(a)),k=f?a.key:a.id):"remove"===b&&f&&(k=a.key||a),g?u.connect(this.mongodb,function(c,e){return c?(e&&e.close(),i.reject(c)):void e.collection(d.id,function(c,g){return c?(e.close(),i.reject(c)):void("get"===b?f?g.find({_id:a.key}).limit(1).toArray(function(a,b){e.close(),a?i.reject(a):0===b.length?i.resolve(null):(delete b[0]._id,d.set(k,b[0],!0).then(function(a){i.resolve(a)},function(a){i.reject(a)}))}):g.find({}).toArray(function(a,b){var c=void 0,f=void 0;return a?(e.close(),i.reject(a)):(c=-1,f=b.length,f>0&&(d.records=b.map(function(a){var b={key:a._id,index:++c,data:{}};return d.indexes.key[b.key]=b.index,b.data=a,delete b.data._id,d.setIndexes(b),b}),d.total=f),e.close(),void i.resolve(d.records))}):"remove"===b?g.remove(f?{_id:k}:{},{safe:!0},function(a,b){e.close(),a?i.reject(a):i.resolve(b)}):"set"===b?f?g.update({_id:a.key},a.data,{w:1,safe:!0,upsert:!0},function(a,b){e.close(),a?i.reject(a):i.resolve(b)}):g.remove({},{w:1,safe:!0},function(a){var b=void 0;return a?(e.close(),i.reject(a)):(b=[],array.each(d.records,function(a){var c={},d=Q();b.push(d),utility.iterate(a.data,function(a,b){c[b]=a}),g.update({_id:a.key},c,{w:1,safe:!0,upsert:!0},function(a,b){a?d.reject(a):d.resolve(b)})}),utility.when(b).then(function(a){e.close(),i.resolve(a)},function(a){e.close(),i.reject(a)}),void 0)}):(e.close(),i.reject(null)))})}):"get"===b?(l=h?sessionStorage.getItem(k):m.getItem(k),null!==l?(l=S.decode(l),f?this.set(k,l,!0).then(function(a){i.resolve(a)},function(a){i.reject(a)}):(utility.merge(e,l),i.resolve(e))):i.resolve(e),i.then(function(){d.loaded=!0},function(a){throw a})):"remove"===b?(h?sessionStorage.removeItem(k):m.removeItem(k),i.resolve(this)):"set"===b?(j=S.encode(f?a.data:{total:this.total,index:this.index,indexes:this.indexes,records:this.records}),h?sessionStorage.setItem(k,j):m.setItem(k,j),i.resolve(this)):i.reject(null)):i.reject(new Error(T.invalidArguments)),i}},{key:"sync",value:function(){var a=this,b=this.events===!0,c=Q(),d=function(d){var f=void 0;return"object"!=typeof d?e(new Error(T.expectedObject)):(null!==a.source&&(d=utility.walk(d,a.source)),f=d instanceof Array?d:[d],void a.batch("set",f,!0).then(function(d){b&&a.dispatch("afterSync",d),c.resolve(d)},e))},e=function(d){b&&a.dispatch("failedSync",d),c.reject(d)};return null===this.uri||string.isEmpty(this.uri)?c.reject(new Error(T.invalidArguments)):(b&&this.dispatch("beforeSync",this.uri),null!==this.callback?H.jsonp(this.uri,{callback:this.callback}).then(d,e):H.request(this.uri,"GET",null,utility.merge({withCredentials:this.credentials},this.headers)).then(d,e)),c}},{key:"teardown",value:function(){var a=this.uri,b=void 0;return null!==a&&(F.expire(a,!0),b=this.id+"DataExpire",utility.clearTimers(b),array.each(this.records,function(b){var c=a+"/"+b.key;F.expire(c,!0)})),array.each(this.lists,function(a){a.teardown(!0)}),this.clear(!0),this.dispatch("afterTeardown"),this}},{key:"undo",value:function(a,b){var c=this.get(a),d=Q(),e=this.versions[c.key],f=void 0;return void 0===c?d.reject(new Error(T.invalidArguments)):e?(f=e.get(b||e.first),void 0===f?d.reject(T.datastoreNoPrevVersion):this.set(a,f).then(function(a){d.resolve(a)},function(a){d.reject(a)})):d.reject(T.datastoreNoPrevVersion),d}},{key:"unique",value:function(a){return array.unique(this.records.map(function(b){return b.data[a]}))}},{key:"update",value:function(a,b){var c=this.get(a),d=Q();return void 0===c?d.reject(new Error(T.invalidArguments)):this.set(a,utility.merge(c.data,b)).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d}}]),b}(E),store={factory:function(a,b){var c=new X;return b instanceof Object&&utility.merge(c,b),null!==a&&"object"==typeof a&&c.batch("set",a),c},worker:function(a){var b=a.data.cmd,c=a.data.records,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0;"select"===b?(k=JSON.parse(a.data.where),f=a.data.functions,d=array.fromObject(k),
			j=array.flat(d).filter(function(a,b){return b%2===0}).sort(array.sort),h=j.join("|"),l=j.map(function(a){return k[a]}).join("|"),g=a.data.indexes,e="return ( ",0===f.length&&g[h]?i=(g[h][l]||[]).map(function(a){return c[a]}):(d.length>1?array.each(d,function(a,b){var c="( ";b>0&&(c=" && ( "),e+=array.contains(f,a[0])?c+a[1]+'( rec.data["'+a[0]+'"] ) )':isNaN(a[1])?c+'rec.data["'+a[0]+'"] === "'+a[1]+'" )':c+'rec.data["'+a[0]+'"] === '+a[1]+" )"}):e+=array.contains(f,d[0][0])?d[0][1]+'( rec.data["'+d[0][0]+'"] )':isNaN(d[0][1])?'rec.data["'+d[0][0]+'"] === "'+d[0][1]+'"':'rec.data["'+d[0][0]+'"] === '+d[0][1],e+=" );",i=c.filter(new Function("rec",e)))):"sort"===b&&(i=array.keySort(c,a.data.query,"data")),postMessage(i)}},string={capitalize:function(a){var b=void 0===arguments[1]?!1:arguments[1],c=void 0;return c=b?string.explode(a," ").map(function(a){return a.charAt(0).toUpperCase()+a.slice(1)}).join(" "):a.charAt(0).toUpperCase()+a.slice(1)},escape:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\/\^\$|#\s]/g,"\\$&")},explode:function(a){var b=void 0===arguments[1]?",":arguments[1];return string.trim(a).split(new RegExp("\\s*"+b+"\\s*"))},fromObject:function(a,b){var c=(b?b+" = {":"{")+"\n";return utility.iterate(a,function(a,b){c+='"'+b+'":'+a.toString()+",\n"}),c=c.replace(/\[object Object\]/g,"{}").replace(/,\n$/,"\n")+"}"},hyphenate:function(a){var b=void 0===arguments[1]?!1:arguments[1],c=string.trim(a).replace(/\s+/g,"-");return b===!0&&(c=c.replace(/([A-Z])/g,"-$1").toLowerCase()),c},isBoolean:function(a){return regex.bool.test(a)},isEmpty:function(a){return""===string.trim(a)},isNumber:function(a){return regex.number.test(a)},isUrl:function(a){return regex.url.test(a)},toCamelCase:function(a){var b=string.trim(a).replace(/\.|_|-|\@|\[|\]|\(|\)|\#|\$|\%|\^|\&|\*|\s+/g," ").toLowerCase().split(regex.space_hyphen),c=[];return array.each(b,function(a,b){c.push(0===b?a:string.capitalize(a))}),c.join("")},singular:function(a){return a.replace(/oe?s$/,"o").replace(/ies$/,"y").replace(/ses$/,"se").replace(/s$/,"")},toFunction:function(a){var b=string.trim(a.replace(/^.*\(/,"").replace(/[\t|\r|\n|\"|\']+/g,"").replace(/\).*/,"")),c=string.trim(a.replace(/^.*\{/,"").replace(/\}$/,""));return Function.apply(Function,string.explode(b).concat([c]))},trim:function(a){return a.replace(/^(\s+|\t+|\n+)|(\s+|\t+|\n+)$/g,"")},unCamelCase:function(a){return string.trim(a.replace(/([A-Z])/g," $1").toLowerCase())},uncapitalize:function(a){var b=string.trim(a);return b.charAt(0).toLowerCase()+b.slice(1)},unhyphenate:function(a){var b=void 0===arguments[1]?!1:arguments[1];return b!==!0?string.explode(a,"-").join(" "):string.explode(a,"-").map(function(a){return string.capitalize(a)}).join(" ")}},utility={timer:{},$:function(a){var b=void 0;return a&&(regex.html.test(a)?b=[R.create(a)]:(a=string.trim(a),-1===a.indexOf(",")?(b=utility.dom(a),b?isNaN(b.length)&&(b=[b]):b=[]):(b=[],array.each(string.explode(a),function(a){var c=utility.dom(a);c instanceof Array?b=b.concat(c):c&&b.push(c)})))),b},banner:function(){console.log([" __          .__             .__   ____     ________      ____  ________","|  | __ ____ |__| _________  |__| /_   |    \\_____  \\    /_   |/  _____/","|  |/ // __ \\|  |/ ___\\__  \\ |  |  |   |      _(__  <     |   /   __  \\ ","|    <\\  ___/|  / /_/  > __ \\|  |  |   |     /       \\    |   \\  |__\\  \\","|__|_ \\\\___  >__\\___  (____  /__|  |___| /\\ /______  / /\\ |___|\\_____  /","     \\/    \\/  /_____/     \\/            \\/        \\/  \\/            \\/ "].join("\n"))},base:function(a){var b=new E;return a instanceof Object&&utility.merge(b,a),b.observer=D(),b},blob:function(b){var c=void 0;try{c=new Blob([b],{type:"application/javascript"})}catch(d){a.BlobBuilder||(a.BlobBuilder=a.MSBlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder),c=(new a.BlobBuilder).append(b).getBlob()}return c},clearTimers:function(a){utility.timer[a]&&(clearTimeout(utility.timer[a]),delete utility.timer[a])},clone:function da(a){var b=void 0===arguments[1]?!1:arguments[1],da=void 0,c=void 0;return b===!0?void 0!==a&&null!==a?JSON.parse(JSON.stringify(a)):a:!a||regex.primitive.test(typeof a)||a instanceof RegExp?a:a instanceof Array?(c=[],array.each(a,function(a,b){c[b]=utility.clone(a)}),c):!e&&!H.ie&&a instanceof Document?$.decode($.encode(a)):"undefined"!=typeof a.__proto__?utility.extend(a.__proto__,a):a instanceof Object?(da=S.encode(a,!0),void 0!==da?(da=S.decode(da),utility.iterate(a,function(a,b){"function"==typeof a&&(da[b]=a)})):da=a,da):a},coerce:function(a){var b=void 0;return null===a||void 0===a?void 0:"true"===a?!0:"false"===a?!1:"null"===a?null:"undefined"===a?void 0:""===a?a:isNaN(b=Number(a))?regex.json_wrap.test(a)?S.decode(a,!0)||a:a:b},compile:function(a,b,c){return a.compile(b,c),!0},curry:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];var e=a.apply(a,c);return function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return e.apply(e,b)}},defer:function(a){var b=void 0===arguments[1]?0:arguments[1],c=void 0===arguments[2]?void 0:arguments[2];return"string"==typeof c?utility.clearTimers(c):c=utility.uuid(!0),utility.timer[c]=setTimeout(function(){utility.clearTimers(c),a()},b),c},delay:function(){return"undefined"!=typeof setImmediate?function(a){setImmediate(a)}:"undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)}}(),dom:function(a){var c=void 0;return c=regex.selector_complex.test(a)?array.cast(b.querySelectorAll(a)):regex.hash.test(a)?b.getElementById(a.replace(regex.hash,""))||void 0:array.cast(regex.klass.test(a)?b.getElementsByClassName(a.replace(regex.klass,"")):regex.word.test(a)?b.getElementsByTagName(a):b.querySelectorAll(a))},domId:function(a){return"a"+a.replace(/-/g,"").slice(1)},equal:function(a,b){return S.encode(a,!0)===S.encode(b,!0)},error:function(a,b,c,d){var e={arguments:b?array.cast(b):[],message:a.message||a,number:a.number?65535&a.number:void 0,scope:c,stack:a.stack||void 0,timestamp:(new Date).toUTCString(),type:a.type||"TypeError"};return utility.log(e.stack||e.message,d!==!0?"error":"warn"),e},extend:function(a,b){var c=Object.create(a);return b instanceof Object&&utility.merge(c,b),c["super"]=a,c},genId:function(a){var b=void 0===arguments[1]?!1:arguments[1],c=void 0;if(a&&(a.id||a instanceof Array||"string"==typeof a||a instanceof String))return a;if(b){do c=utility.domId(utility.uuid(!0));while(utility.dom("#"+c))}else c=utility.domId(utility.uuid(!0));return a&&"object"==typeof a?(a.id=c,a):c},iterate:function(a,b){return array.each(Object.keys(a),function(c){return b.call(a,a[c],c)}),a},log:function(a){var b=void 0===arguments[1]?"log":arguments[1],c="object"!=typeof a?"["+(new Date).toLocaleTimeString()+"] "+a:a;console[b](c)},merge:function(a,b){var c=Object.keys(a);return utility.iterate(b,function(b,d){!array.contains(c,d)||b instanceof Function?a[d]=b:a[d]instanceof Array&&b instanceof Array?array.merge(a[d],b):b instanceof Function?a[d]=b:a[d]instanceof Object&&b instanceof Object?utility.iterate(b,function(b,c){a[d][c]=utility.clone(b)}):a[d]=utility.clone(b)}),a},parse:function(a){var d={},f=void 0,g=void 0,h=void 0;return void 0===a&&(a=e?"":c.href),e?d=v.parse(a):(d=b.createElement("a"),d.href=a,f=d.href.match(regex.host)[1],h=d.href.match(regex.protocol)[1]),e&&utility.iterate(d,function(a,b){null===a&&(d[b]=void 0)}),g={auth:e?null:regex.auth.exec(a),protocol:d.protocol||h,hostname:d.hostname||f,port:d.port?V.parse(d.port,10):"",pathname:d.pathname,search:d.search||"",hash:d.hash||"",host:d.host||f},H.ie&&(":"===g.protocol&&(g.protocol=c.protocol),string.isEmpty(g.hostname)&&(g.hostname=c.hostname),string.isEmpty(g.host)&&(g.host=c.host),"/"!==g.pathname.charAt(0)&&(g.pathname="/"+g.pathname)),g.auth=d.auth||(null===g.auth?"":g.auth[1]),g.href=d.href||g.protocol+"//"+(string.isEmpty(g.auth)?"":g.auth+"@")+g.host+g.pathname+g.search+g.hash,g.path=d.path||g.pathname+g.search,g.query=utility.queryString(null,g.search),g},partial:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return function(){for(var b=arguments.length,d=Array(b),e=0;b>e;e++)d[e]=arguments[e];return a.apply(a,c.concat(d))}},prevent:function(a){return"function"==typeof a.preventDefault&&a.preventDefault(),a},queryString:function(a){var b=void 0===arguments[1]?"":arguments[1],d={},e=(b||c.search||"").replace(/.*\?/,"");return array.each(e.split("&"),function(a){var b=a.split("=");string.isEmpty(b[0])||(void 0===b[1]?b[1]="":b[1]=utility.coerce(decodeURIComponent(b[1])),void 0===d[b[0]]?d[b[0]]=b[1]:d[b[0]]instanceof Array?d[b[0]].push(b[1]):(d[b[0]]=[d[b[0]]],d[b[0]].push(b[1])))}),"string"==typeof a?utility.walk(d,a):d},race:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var d=Q();return b[0]instanceof Array&&(b=b[0]),0===b.length?d.resolve(null):l.race(b).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d},render:function(a){var b=Q();return w(function(c){try{b.resolve(a(c))}catch(d){b.reject(d)}}),b},repeat:function(a){var b=void 0===arguments[1]?10:arguments[1],c=void 0===arguments[2]?utility.uuid(!0):arguments[2],d=void 0===arguments[3]?!0:arguments[3],e=void 0;return d&&a()===!1?void 0:(e=function(){a()!==!1&&utility.defer(e,b,c)},utility.defer(e,b,c),c)},stop:function(a){return"function"==typeof a.stopPropagation&&a.stopPropagation(),utility.prevent(a),a},target:function(a){return a.target||a.srcElement},uuid:function(a){function b(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var c=[8,9,"a","b"],d=b()+b()+"-"+b()+"-4"+b().substr(0,3)+"-"+c[Math.floor(4*Math.random())]+b().substr(0,3)+"-"+b()+b()+b();return a===!0&&(d=d.replace(/-/g,"")),d},walk:function(a,b){var c=a;return array.each(b.replace(/\]$/,"").replace(/\]/g,".").replace(/\.\./g,".").split(/\.|\[/),function(a){return void 0===c[a]||null===c[a]?(c=void 0,!1):void(c=c[a])}),c},when:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var d=Q();return b[0]instanceof Array&&(b=b[0]),0===b.length?d.resolve(null):l.all(b).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d},worker:function(a){var b=new Worker(y);return b.onerror=function(c){a.reject(c),b.terminate()},b.onmessage=function(c){a.resolve(c.data),b.terminate()},b}},Y=function(){var a=0,b=1,c=2,d=3,e=4,f=/ECONNREFUSED/,g=new RegExp(c+"|"+d),h={"user-agent":"keigai/1.3.16 node.js/"+process.versions.node.replace(/^v/,"")+" ("+string.capitalize(process.platform)+" V8/"+process.versions.v8+" )","content-type":"text/plain",accept:"*/*"},i=function(a,b){var c="on"+b;return"function"==typeof a[c]&&a[c](),a.dispatchEvent(b),a},j=function(a,b){return a.readyState!==b&&(a.readyState=b,i(a,"readystatechange"),a.readyState!==e||a._error||(i(a,"load"),i(a,"loadend"))),a},l=function(a,b){j(a,c),a.status=b.statusCode,a._resheaders=b.headers,a._resheaders["set-cookie"]&&a._resheaders["set-cookie"]instanceof Array&&(a._resheaders["set-cookie"]=a._resheaders["set-cookie"].join(";")),b.on("data",function(c){b.setEncoding("utf8"),a._send&&(c&&(a.responseText+=c),j(a,d))}),b.on("end",function(){a._send&&(j(a,e),a._send=!1)})},m=function(a,b){a.status=f.test(b.message)?503:500,a.statusText="",a.responseText=b.message,a._error=!0,a._send=!1,i(a,"error"),j(a,e)},n=function(d){function f(){_classCallCheck(this,f),_get(Object.getPrototypeOf(f.prototype),"constructor",this).call(this),this.onabort=null,this.onerror=null,this.onload=null,this.onloadend=null,this.onloadstart=null,this.onreadystatechange=null,this.readyState=a,this.response=null,this.responseText="",this.responseType="",this.responseXML=null,this.status=a,this.statusText="",this.observer=D(),this._error=!1,this._headers={},this._params={},this._request=null,this._resheaders={},this._send=!1}return _inherits(f,d),_createClass(f,[{key:"abort",value:function(){return null!==this._request&&(this._request.abort(),this._request=null,this.responseText="",this.responseXML="",this._error=!0,this._headers={},(this._send===!0||g.test(this.readyState))&&(this._send=!1,j(this,e)),i(this,"abort"),this.readyState=a),this}},{key:"getAllResponseHeaders",value:function(){var a="";if(this.readyState<c)throw new Error(T.invalidStateNoHeaders);return utility.iterate(this._resheaders,function(b,c){a+=c+": "+b+"\n"}),a}},{key:"getResponseHeader",value:function(a){if(this.readyState<c||this._error)throw new Error(T.invalidStateNoHeaders);return this._resheaders[a]||this._resheaders[a.toLowerCase()]}},{key:"open",value:function(a,c,d,e,f){var g=this;if(d!==!0)throw new Error(T.invalidStateNoSync);return this.abort(),this._error=!1,this._params={method:a,url:c,async:d||!0,user:e||null,password:f||null},utility.iterate(h,function(a,b){g._headers[b]=a}),this.readyState=b,this}},{key:"overrideMimeType",value:function(a){return this._headers["content-type"]=a,this}},{key:"send",value:function(){var a=this,c=void 0===arguments[0]?null:arguments[0],d=void 0,e=void 0,f=void 0,g=void 0;if(this.readyState<b)throw new Error(T.invalidStateNotOpen);if(this._send)throw new Error(T.invalidStateNotSending);if(e=utility.parse(this._params.url),e.port=e.port||("https:"===e.protocol?443:80),null!==this._params.user&&null!==this._params.password&&(e.auth=this._params.user+":"+this._params.password),regex.put_post.test(this._params.method))if(null===c)this._headers["content-length"]=0;else if("string"==typeof c)this._headers["content-length"]=k.byteLength(c);else{if(!(c instanceof k||"function"==typeof c.toString))throw new Error(T.invalidArguments);c=c.toString(),this._headers["content-length"]=k.byteLength(c)}return this._headers.host=e.host,"XMLHttpRequest"===this._headers["x-requested-with"]&&delete this._headers["x-requested-with"],d={hostname:e.hostname,path:e.path,port:e.port,method:this._params.method,headers:this._headers},"https:"===e.protocol&&(d.rejectUnauthorized=!1,d.agent=!1),e.auth&&(d.auth=e.auth),this._send=!0,i(this,"readystatechange"),g="http:"===e.protocol?s:t,f=g.request(d,function(b){l(a,b)}).on("error",function(b){m(a,b)}),null===c?f.setSocketKeepAlive(!0):f.write(c,"utf8"),this._request=f,f.end(),i(this,"loadstart"),this}},{key:"setRequestHeader",value:function(a,c){if(this.readyState!==b)throw new Error(T.invalidStateNotUsable);if(this._send)throw new Error(T.invalidStateNotSending);return this._headers[a.toLowerCase()]=c,this}}]),f}(E);return n},Z=function(){function a(){_classCallCheck(this,a),this.elements={}}return _createClass(a,[{key:"clear",value:function(){this.elements={}}},{key:"delete",value:function(a){delete this.elements[a]}},{key:"has",value:function(a){return void 0!==this.elements[a]}},{key:"get",value:function(a){return this.has(a)?this.elements[a].value:void 0}},{key:"set",value:function(a,b){return this.elements[a]={value:b},this}}]),a}(),$={decode:function(a){return(new DOMParser).parseFromString(a,"text/xml")},encode:function(a){var b=void 0===arguments[1]?!0:arguments[1],c=void 0===arguments[2]?!0:arguments[2],d=void 0===arguments[3]?"":arguments[3],e=b?"<"+(d||"xml")+">":"";return null!==a&&a.xml&&(a=a.xml),H.doc&&a instanceof Document&&(a=(new XMLSerializer).serializeToString(a)),regex.boolean_number_string.test(typeof a)?e+=$.node(isNaN(d)?d:"item",a):null===a||void 0===a?e+="null":a instanceof Array?array.each(a,function(a){e+=$.encode(a,"object"==typeof a,!1,"item")}):a instanceof Object&&utility.iterate(a,function(a,b){e+=$.encode(a,"object"==typeof a,!1,b)}),e+=b?"</"+(d||"xml")+">":"",c&&(e='<?xml version="1.0" encoding="UTF8"?>'+e),e},node:function(a,b){return"<n>v</n>".replace("v",regex.cdata.test(b)?"<![CDATA["+b+"]]>":b).replace(/<(\/)?n>/g,"<$1"+a+">")},valid:function(a){return 0===$.decode(a).getElementsByTagName("parsererror").length}},_=function(){if(void 0===Array.from&&(Array.from=function(a){return[].slice.call(a)}),e)n=Y();else if(H.version=H.version(),H.ie&&H.version<10)throw new Error(T.upgrade);if(null===o&&(o=Z),q)try{y=a.URL.createObjectURL(utility.blob("var "+string.fromObject(array,"array")+", "+string.fromObject(regex,"regex")+", "+string.fromObject(string,"string")+", "+string.fromObject(utility,"utility")+"; onmessage = "+store.worker.toString()+";"))}catch(b){q=!1}x=(new Date).getTime(),w=void 0!==a.requestAnimationFrame?a.requestAnimationFrame:function(a){var b=(new Date).getTime()-x;utility.defer(function(){a(b)},16,b)},e||utility.banner()};return _(),{filter:K,list:O.factory,grid:M,store:store.factory,util:{$:utility.$,array:array,banner:utility.banner,base:utility.base,clearTimers:utility.clearTimers,clone:utility.clone,coerce:utility.coerce,curry:utility.curry,csv:I,defer:Q,delay:utility.defer,element:R,equal:utility.equal,extend:utility.extend,genId:utility.genId,iterate:utility.iterate,json:S,jsonp:H.jsonp,log:utility.log,lru:B.factory,math:U,merge:utility.merge,next:utility.delay,number:V,observer:D,parse:utility.parse,partial:utility.partial,prevent:utility.prevent,queryString:utility.queryString,race:utility.race,regex:regex,render:utility.render,repeat:utility.repeat,request:H.request,stop:utility.stop,string:string,target:utility.target,uuid:utility.uuid,walk:utility.walk,when:utility.when,xml:$},version:"1.3.16"}}();"undefined"!=typeof exports?module.exports=z:"function"==typeof define?define(function(){return z}):a.keigai=z}("undefined"!=typeof global?global:window);
</script>
<script type="application/javascript">
	/**
	 * humane.js
	 * Humanized Messages for Notifications
	 * @author Marc Harter (@wavded)
	 * @example
	 *   humane.log('hello world');
	 * @license MIT
	 * See more usage examples at: http://wavded.github.com/humane-js/
	 */
	!function(name,context,definition){if(typeof module!=="undefined")module.exports=definition(name,context);else if(typeof define==="function"&&typeof define.amd==="object")define(definition);else context[name]=definition(name,context)}("humane",this,function(name,context){var win=window;var doc=document;var ENV={on:function(el,type,cb){"addEventListener"in win?el.addEventListener(type,cb,false):el.attachEvent("on"+type,cb)},off:function(el,type,cb){"removeEventListener"in win?el.removeEventListener(type,cb,false):el.detachEvent("on"+type,cb)},bind:function(fn,ctx){return function(){fn.apply(ctx,arguments)}},isArray:Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]"},config:function(preferred,fallback){return preferred!=null?preferred:fallback},transSupport:false,useFilter:/msie [678]/i.test(navigator.userAgent),_checkTransition:function(){var el=doc.createElement("div");var vendors={webkit:"webkit",Moz:"",O:"o",ms:"MS"};for(var vendor in vendors)if(vendor+"Transition"in el.style){this.vendorPrefix=vendors[vendor];this.transSupport=true}}};ENV._checkTransition();var Humane=function(o){o||(o={});this.queue=[];this.baseCls=o.baseCls||"humane";this.addnCls=o.addnCls||"";this.timeout="timeout"in o?o.timeout:2500;this.waitForMove=o.waitForMove||false;this.clickToClose=o.clickToClose||false;this.timeoutAfterMove=o.timeoutAfterMove||false;this.container=o.container;try{this._setupEl()}catch(e){ENV.on(win,"load",ENV.bind(this._setupEl,this))}};Humane.prototype={constructor:Humane,_setupEl:function(){var el=doc.createElement("div");el.style.display="none";if(!this.container){if(doc.body)this.container=doc.body;else throw"document.body is null"}this.container.appendChild(el);this.el=el;this.removeEvent=ENV.bind(function(){var timeoutAfterMove=ENV.config(this.currentMsg.timeoutAfterMove,this.timeoutAfterMove);if(!timeoutAfterMove){this.remove()}else{setTimeout(ENV.bind(this.remove,this),timeoutAfterMove)}},this);this.transEvent=ENV.bind(this._afterAnimation,this);this._run()},_afterTimeout:function(){if(!ENV.config(this.currentMsg.waitForMove,this.waitForMove))this.remove();else if(!this.removeEventsSet){ENV.on(doc.body,"mousemove",this.removeEvent);ENV.on(doc.body,"click",this.removeEvent);ENV.on(doc.body,"keypress",this.removeEvent);ENV.on(doc.body,"touchstart",this.removeEvent);this.removeEventsSet=true}},_run:function(){if(this._animating||!this.queue.length||!this.el)return;this._animating=true;if(this.currentTimer){clearTimeout(this.currentTimer);this.currentTimer=null}var msg=this.queue.shift();var clickToClose=ENV.config(msg.clickToClose,this.clickToClose);if(clickToClose){ENV.on(this.el,"click",this.removeEvent);ENV.on(this.el,"touchstart",this.removeEvent)}var timeout=ENV.config(msg.timeout,this.timeout);if(timeout>0)this.currentTimer=setTimeout(ENV.bind(this._afterTimeout,this),timeout);if(ENV.isArray(msg.html))msg.html="<ul><li>"+msg.html.join("<li>")+"</ul>";this.el.innerHTML=msg.html;this.currentMsg=msg;this.el.className=this.baseCls;if(ENV.transSupport){this.el.style.display="block";setTimeout(ENV.bind(this._showMsg,this),50)}else{this._showMsg()}},_setOpacity:function(opacity){if(ENV.useFilter){try{this.el.filters.item("DXImageTransform.Microsoft.Alpha").Opacity=opacity*100}catch(err){}}else{this.el.style.opacity=String(opacity)}},_showMsg:function(){var addnCls=ENV.config(this.currentMsg.addnCls,this.addnCls);if(ENV.transSupport){this.el.className=this.baseCls+" "+addnCls+" "+this.baseCls+"-animate"}else{var opacity=0;this.el.className=this.baseCls+" "+addnCls+" "+this.baseCls+"-js-animate";this._setOpacity(0);this.el.style.display="block";var self=this;var interval=setInterval(function(){if(opacity<1){opacity+=.1;if(opacity>1)opacity=1;self._setOpacity(opacity)}else clearInterval(interval)},30)}},_hideMsg:function(){var addnCls=ENV.config(this.currentMsg.addnCls,this.addnCls);if(ENV.transSupport){this.el.className=this.baseCls+" "+addnCls;ENV.on(this.el,ENV.vendorPrefix?ENV.vendorPrefix+"TransitionEnd":"transitionend",this.transEvent)}else{var opacity=1;var self=this;var interval=setInterval(function(){if(opacity>0){opacity-=.1;if(opacity<0)opacity=0;self._setOpacity(opacity)}else{self.el.className=self.baseCls+" "+addnCls;clearInterval(interval);self._afterAnimation()}},30)}},_afterAnimation:function(){if(ENV.transSupport)ENV.off(this.el,ENV.vendorPrefix?ENV.vendorPrefix+"TransitionEnd":"transitionend",this.transEvent);if(this.currentMsg.cb)this.currentMsg.cb();this.el.style.display="none";this._animating=false;this._run()},remove:function(e){var cb=typeof e=="function"?e:null;ENV.off(doc.body,"mousemove",this.removeEvent);ENV.off(doc.body,"click",this.removeEvent);ENV.off(doc.body,"keypress",this.removeEvent);ENV.off(doc.body,"touchstart",this.removeEvent);ENV.off(this.el,"click",this.removeEvent);ENV.off(this.el,"touchstart",this.removeEvent);this.removeEventsSet=false;if(cb&&this.currentMsg)this.currentMsg.cb=cb;if(this._animating)this._hideMsg();else if(cb)cb()},log:function(html,o,cb,defaults){var msg={};if(defaults)for(var opt in defaults)msg[opt]=defaults[opt];if(typeof o=="function")cb=o;else if(o)for(var opt in o)msg[opt]=o[opt];msg.html=html;if(cb)msg.cb=cb;this.queue.push(msg);this._run();return this},spawn:function(defaults){var self=this;return function(html,o,cb){self.log.call(self,html,o,cb,defaults);return self}},create:function(o){return new Humane(o)}};return new Humane});
</script>
<script type="application/javascript">
	(function ( keigai ) {
		var util = keigai.util,
			$ = util.$,
			array = util.array,
			element = util.element,
			json = util.json,
			regex = util.regex,
			render = util.render,
			request = util.request,
			string = util.string,
			code = $( "code" )[ 0 ],
			formats = $( "select" )[ 0 ],
			observable = util.observer(),
			parsed = keigai.util.parse(),
			csrf = "{{csrf}}",
			nav;

		// Stage 1 of prettifying a <code>
		function prepare ( html ) {
			var keys, matches, replaces;

			// Preparing to change <pre> into Elements
			keys = html.match( /\".*":/g );
			matches = keys.concat( html.match( /:\s(\".*\"|\d{3,3}|null)/g ) );
			replaces = matches.map( function ( i ) {
				if ( keys.indexOf( i ) > -1 ) {
					return i.replace( /(\".*\")/, "<span class='key'>$1</span>" );
				}
				else {
					return i.replace( /(\".*\"|\d{3,3}|null)/, "<span class='item'>$1</span>" );
				}
			} );

			array.each( matches, function ( i, idx ) {
				html = html.replace( new RegExp( string.escape( i ), "g" ), replaces[ idx ] )
			} );

			return html;
		}

		// Prettifies a <code>
		function prettify ( arg ) {
			// Changing <pre> into selectable Elements
			arg.parentNode.parentNode.innerHTML = prepare( arg.innerHTML )
					.replace( /\n/g, "<br>\n" )
					.replace( /(\s{2,2})/g, "<span class='spaces'></span>" );

			// Changing URIs into anchors
			array.each( $( ".item" ), function ( i ) {
				var html = i.innerHTML,
					val = html.replace( /(^\"|\"$)/g, "" );

				if ( val.indexOf( "://" ) > -1 ) {
					html = html.replace( val, "<a href='" + val + "' title='View " + val + "'>" + val + "</a>" );
				}

				i.innerHTML = html;
			} );
		}

		// Setting up humane
		humane.error = humane.spawn( { addnCls : 'humane-jackedup-error', timeout : 3000 } );
		humane.success = humane.spawn( { addnCls : 'humane-jackedup-success', timeout : 3000 } );

		// Resetting for someone returning to the HTML renderer from another format
		element.val( formats, "html" );

		// Hooking into the input
		observable.hook( formats, "change" );
		observable.on( "change", function () {
			var value = element.val( formats );

			// This shouldn't happen, but lets assume it does...
			if ( value === "html" ) {
				return;
			}

			if ( value && value !== parsed.query.format ) {
				if ( parsed.query.format ) {
					location.href = parsed.href.replace( /format=(\w*)/, "format=" + value );
				}
				else if ( !location.search ) {
					location.search = "?format=" + value;
				}
				else {
					location.search += "&format=" + value;
				}
			}
		} );

		render( function () {
			var del = /DELETE/,
				a = /A/,
				body = $( "#body" )[ 0 ],
				form = $( "#io form" )[ 0 ],
				reset = $( "button[type='reset']" )[ 0 ],
				headers, methods, observable, result, resultCode;

			function clear () {
				element.addClass( result, "hidden" );
				result.querySelector( ".code" ).innerHTML = "<pre><code></code></pre>";
				resultCode = result.querySelector( "code" );
			}

			function toggle ( type ) {
				render( function () {
					if ( del.test( type ) ) {
						element.addClass( body, "hidden" );
						element.addClass( reset, "hidden" );
					}
					else {
						element.removeClass( body, "hidden" );
						element.removeClass( reset, "hidden" );
					}
				} );
			}

			prettify( code );

			if ( /PATCH|POST|PUT/.test( $( "#methods" )[ 0 ].innerText ) ) {
				methods = $( "#methods" );
				observable = util.observer();
				nav = $( "#io nav" )[ 0 ];
				result = $( "#result" )[ 0 ];
				resultCode = result.querySelector( "code" );
				headers = {
					"accept" : "application/json",
					"content-type" : "application/json",
				};

				if ( csrf ) {
					headers[ "x-csrf-token" ] = csrf;
				}

				// Toggling IO nav
				element.removeClass( nav, "hidden" );

				// Enabling navigation
				observable.hook( nav, "click" );
				observable.on( "click", function ( e ) {
					var anchor = util.target( e ),
						type, target;

					util.stop( e );

					if ( !a.test( anchor.nodeName ) ) {
						return;
					}

					type = element.data( anchor, "type" );
					target = $( "#io ." + type )[ 0 ];

					if ( element.hasClass( target, "active" ) ) {
						return;
					}

					render( function () {
						element.addClass( anchor, "active" );
						element.removeClass( ( anchor.parentNode.nextElementSibling || anchor.parentNode.previousElementSibling ).childNodes[ 0 ], "active" );
						element.removeClass( target, "hidden" );
						element.addClass( ( target.nextElementSibling || target.previousElementSibling ), "hidden" );
					} );
				} );

				// Reacting to a method change
				observable.hook( methods, "change" );
				observable.on( "change", function ( e ) {
					util.stop( e );
					toggle( element.val( methods ) );
				} );

				// Intercepting form events
				observable.hook( form, "reset" );
				observable.hook( form, "submit" );

				observable.on( "reset", function () {
					render( clear );
				} );

				observable.on( "submit", function ( e ) {
					var method = element.val( methods ),
						payload;

					util.stop( e );
					render( clear );

					if ( !del.test( method ) ) {
						payload = element.val( $( "textarea" )[ 0 ] ) || "";

						if ( payload !== "" ) {
							try {
								// Handles Arrays, Objects & Primitives
								if ( regex.json_wrap.test( payload ) ) {
									payload = JSON.stringify( payload );
								}

								payload = JSON.stringify( JSON.parse( payload ) );
							}
							catch ( e ) {
								humane.error( "Invalid JSON" );
								console.error( e.stack );
								return;
							}
						}
					}

					request( parsed.href, method, payload, headers ).then( function ( arg ) {
						humane.success( "Success!" );

						render( function () {
							resultCode.innerHTML = JSON.stringify( arg, null, 2 );
							prettify( resultCode );
							element.removeClass( result, "hidden" );
						} );
					}, function ( e ) {
						var data = json.decode( e.message, true ) || { error : e.message || "An error has occurred" };

						humane.error( data.error );
						render( function () {
							resultCode.innerHTML = JSON.stringify( data, null, 2 );
							prettify( resultCode );
							element.removeClass( result, "hidden" );
						} );
					} );
				} );

				// Initial render
				toggle( element.val( methods ) );
			}
		} );
	})( keigai );
</script>
</body>
</html>
