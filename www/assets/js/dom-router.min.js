/* 2017 Jason Mulligan <jason.mulligan@avoidwork.com> */

"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a,b){function c(c){var d=new Router(c),f=a.location.hash.replace("#",""),h=function(a){return d.hashchange.call(d,a)};return"addEventListener"in b?b.addEventListener("hashchange",h,!1):b.onhashchange=h,d.scan(d.start),g(d.css.hidden,d.ctx.classList)||(""!==f&&e(d.routes,f)?d.hashchange({oldURL:"",newURL:a.location.hash}):d.route(d.start)),d}var d=/.*\#/,e=Array.contains||function(a,b){return a.indexOf(b)>-1},f=Array.from||function(a){return[].slice.call(a)},g=function(a,b){return a in b},h=(new Date).getTime(),i=b.requestAnimationFrame||function(a){setTimeout(a((new Date).getTime()-h),16)},j=function a(b){_classCallCheck(this,a),this.hash=b.hash,this.element=b.element,this.trigger=b.trigger,this.timestamp=(new Date).toISOString()},Router=function(){function Router(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.active,d=void 0===c||c,e=b.callback,f=void 0===e?function(){}:e,g=b.css,h=void 0===g?{current:"dr-current",hidden:"dr-hidden"}:g,i=b.ctx,j=void 0===i?a.body:i,k=b.start,l=void 0===k?null:k,m=b.delimiter,n=void 0===m?"/":m,o=b.logging,p=void 0!==o&&o,q=b.stop,r=void 0===q||q;_classCallCheck(this,Router),this.active=d,this.callback=f,this.css=h,this.ctx=j,this.start=l,this.delimiter=n,this.history=[],this.logging=p,this.routes=[],this.stop=r}return _createClass(Router,[{key:"current",value:function(){return this.history[0]}},{key:"hashchange",value:function(a){var b=this,c=this,f=e(a.oldURL,"#")?a.oldURL.replace(d,""):null,g=e(a.newURL,"#")?a.newURL.replace(d,""):null;this.active&&(this.stop===!0&&"function"==typeof a.stopPropagation&&(a.stopPropagation(),"function"==typeof a.preventDefault&&a.preventDefault()),e(this.routes,g)?i(function(){var a=f?f.split(c.delimiter):[],d=g.split(c.delimiter),e=void 0,h=void 0;d.forEach(function(b,f){var g=f+1,i=a.length>=g,j=i?c.select("#"+a.slice(0,g).join(" > #"))[0]:null,k=i?c.select("a[href='#"+a.slice(0,g).join(c.delimiter)+"']")[0]:null;e=c.select("#"+d.slice(0,g).join(" > #"))[0],h=c.select("a[href='#"+d.slice(0,g).join(c.delimiter)+"']")[0],c.load(k||null,j||null,h||null,e||null)},b),c.css.current&&c.history.length>0&&c.history[0].trigger.classList.remove(c.css.current);var i=new j({element:e||null,hash:g,trigger:h||null});c.log(i),c.callback(i)}):this.route(this.routes.filter(function(a){return e(a,g)})[0]||this.start))}},{key:"load",value:function(a,b,c,d){return a&&this.css.current&&a.classList.remove(this.css.current),b&&b.id!==d.id&&b.classList.add(this.css.hidden),c&&this.css.current&&c.classList.add(this.css.current),d&&this.sweep(d,this.css.hidden),this}},{key:"log",value:function(a){return this.logging&&this.history.unshift(a),this}},{key:"route",value:function(b){return a.location.hash=b,this}},{key:"select",value:function(a){return f(this.ctx.querySelectorAll.call(this.ctx,a))}},{key:"scan",value:function(a){return this.routes=this.select("a").filter(function(a){return e(a.href,"#")}).map(function(a){return a.href.replace(d,"")}),this.start=a||this.routes[0],this}},{key:"sweep",value:function(a,b){return f(a.parentNode.childNodes).filter(function(b){return 1===b.nodeType&&b.id&&b.id!==a.id}).forEach(function(a){return a.classList.add(b)}),a.classList.remove(b),this}}]),Router}();c.version="2.0.0","undefined"!=typeof exports?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):b.router=c}(document,window);
//# sourceMappingURL=dom-router.min.js.map