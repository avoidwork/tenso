{"version":3,"sources":["dom-router.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","document","window","factory","arg","obj","Router","hash","location","replace","facade","ev","hashchange","call","addEventListener","onhashchange","scan","start","has","css","hidden","ctx","classList","contains","routes","oldURL","newURL","route","not_hash","Array","indexOf","from","slice","a","b","time","Date","getTime","render","requestAnimationFrame","fn","setTimeout","Route","cfg","this","element","trigger","timestamp","toISOString","_ref","arguments","undefined","_ref$active","active","_ref$callback","callback","_ref$css","current","_ref$ctx","body","_ref$start","_ref$delimiter","delimiter","_ref$logging","logging","_ref$stop","stop","history","value","_this","self","oldHash","newHash","stopPropagation","preventDefault","oldHashes","split","newHashes","newEl","newTrigger","forEach","idx","nth","valid","oldEl","select","join","oldTrigger","load","remove","r","log","filter","id","add","sweep","unshift","querySelectorAll","href","map","klass","parentNode","childNodes","nodeType","version","exports","module","define","amd","router"],"mappings":"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","file":"dom-router.min.js","sourcesContent":["\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * URL hash to DOM router\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2017\r\n * @license BSD-3-Clause\r\n * @version 2.0.0\r\n */\n(function (document, window) {\n\tvar not_hash = /.*\\#/,\n\t    contains = Array.contains || function (obj, arg) {\n\t\treturn obj.indexOf(arg) > -1;\n\t},\n\t    from = Array.from || function (arg) {\n\t\treturn [].slice.call(arg);\n\t},\n\t    has = function has(a, b) {\n\t\treturn a in b;\n\t},\n\t    time = new Date().getTime(),\n\t    render = window.requestAnimationFrame || function (fn) {\n\t\tsetTimeout(fn(new Date().getTime() - time), 16);\n\t};\n\n\tvar Route = function Route(cfg) {\n\t\t_classCallCheck(this, Route);\n\n\t\tthis.hash = cfg.hash;\n\t\tthis.element = cfg.element;\n\t\tthis.trigger = cfg.trigger;\n\t\tthis.timestamp = new Date().toISOString();\n\t};\n\n\tvar Router = function () {\n\t\tfunction Router() {\n\t\t\tvar _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t\t\t    _ref$active = _ref.active,\n\t\t\t    active = _ref$active === undefined ? true : _ref$active,\n\t\t\t    _ref$callback = _ref.callback,\n\t\t\t    callback = _ref$callback === undefined ? function () {} : _ref$callback,\n\t\t\t    _ref$css = _ref.css,\n\t\t\t    css = _ref$css === undefined ? { current: \"dr-current\", hidden: \"dr-hidden\" } : _ref$css,\n\t\t\t    _ref$ctx = _ref.ctx,\n\t\t\t    ctx = _ref$ctx === undefined ? document.body : _ref$ctx,\n\t\t\t    _ref$start = _ref.start,\n\t\t\t    start = _ref$start === undefined ? null : _ref$start,\n\t\t\t    _ref$delimiter = _ref.delimiter,\n\t\t\t    delimiter = _ref$delimiter === undefined ? \"/\" : _ref$delimiter,\n\t\t\t    _ref$logging = _ref.logging,\n\t\t\t    logging = _ref$logging === undefined ? false : _ref$logging,\n\t\t\t    _ref$stop = _ref.stop,\n\t\t\t    stop = _ref$stop === undefined ? true : _ref$stop;\n\n\t\t\t_classCallCheck(this, Router);\n\n\t\t\tthis.active = active;\n\t\t\tthis.callback = callback;\n\t\t\tthis.css = css;\n\t\t\tthis.ctx = ctx;\n\t\t\tthis.start = start;\n\t\t\tthis.delimiter = delimiter;\n\t\t\tthis.history = [];\n\t\t\tthis.logging = logging;\n\t\t\tthis.routes = [];\n\t\t\tthis.stop = stop;\n\t\t}\n\n\t\t_createClass(Router, [{\n\t\t\tkey: \"current\",\n\t\t\tvalue: function current() {\n\t\t\t\treturn this.history[0];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"hashchange\",\n\t\t\tvalue: function hashchange(ev) {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tvar self = this,\n\t\t\t\t    oldHash = contains(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null,\n\t\t\t\t    newHash = contains(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\n\n\t\t\t\tif (this.active) {\n\t\t\t\t\tif (this.stop === true && typeof ev.stopPropagation === \"function\") {\n\t\t\t\t\t\tev.stopPropagation();\n\n\t\t\t\t\t\tif (typeof ev.preventDefault === \"function\") {\n\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!contains(this.routes, newHash)) {\n\t\t\t\t\t\tthis.route(this.routes.filter(function (i) {\n\t\t\t\t\t\t\treturn contains(i, newHash);\n\t\t\t\t\t\t})[0] || this.start);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trender(function () {\n\t\t\t\t\t\t\tvar oldHashes = oldHash ? oldHash.split(self.delimiter) : [];\n\t\t\t\t\t\t\tvar newHashes = newHash.split(self.delimiter);\n\t\t\t\t\t\t\tvar newEl = void 0,\n\t\t\t\t\t\t\t    newTrigger = void 0;\n\n\t\t\t\t\t\t\tnewHashes.forEach(function (i, idx) {\n\t\t\t\t\t\t\t\tvar nth = idx + 1;\n\t\t\t\t\t\t\t\tvar valid = oldHashes.length >= nth;\n\t\t\t\t\t\t\t\tvar oldEl = valid ? self.select(\"#\" + oldHashes.slice(0, nth).join(\" > #\"))[0] : null;\n\t\t\t\t\t\t\t\tvar oldTrigger = valid ? self.select(\"a[href='#\" + oldHashes.slice(0, nth).join(self.delimiter) + \"']\")[0] : null;\n\n\t\t\t\t\t\t\t\tnewEl = self.select(\"#\" + newHashes.slice(0, nth).join(\" > #\"))[0];\n\t\t\t\t\t\t\t\tnewTrigger = self.select(\"a[href='#\" + newHashes.slice(0, nth).join(self.delimiter) + \"']\")[0];\n\n\t\t\t\t\t\t\t\tself.load(oldTrigger || null, oldEl || null, newTrigger || null, newEl || null);\n\t\t\t\t\t\t\t}, _this);\n\n\t\t\t\t\t\t\tif (self.css.current && self.history.length > 0) {\n\t\t\t\t\t\t\t\tself.history[0].trigger.classList.remove(self.css.current);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar r = new Route({ element: newEl || null, hash: newHash, trigger: newTrigger || null });\n\n\t\t\t\t\t\t\tself.log(r);\n\t\t\t\t\t\t\tself.callback(r);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"load\",\n\t\t\tvalue: function load(oldTrigger, oldEl, newTrigger, newEl) {\n\t\t\t\tif (oldTrigger && this.css.current) {\n\t\t\t\t\toldTrigger.classList.remove(this.css.current);\n\t\t\t\t}\n\n\t\t\t\tif (oldEl && oldEl.id !== newEl.id) {\n\t\t\t\t\toldEl.classList.add(this.css.hidden);\n\t\t\t\t}\n\n\t\t\t\tif (newTrigger && this.css.current) {\n\t\t\t\t\tnewTrigger.classList.add(this.css.current);\n\t\t\t\t}\n\n\t\t\t\tif (newEl) {\n\t\t\t\t\tthis.sweep(newEl, this.css.hidden);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"log\",\n\t\t\tvalue: function log(arg) {\n\t\t\t\tif (this.logging) {\n\t\t\t\t\tthis.history.unshift(arg);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"route\",\n\t\t\tvalue: function route(arg) {\n\t\t\t\tdocument.location.hash = arg;\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"select\",\n\t\t\tvalue: function select(arg) {\n\t\t\t\treturn from(this.ctx.querySelectorAll.call(this.ctx, arg));\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"scan\",\n\t\t\tvalue: function scan(arg) {\n\t\t\t\tthis.routes = this.select(\"a\").filter(function (i) {\n\t\t\t\t\treturn contains(i.href, \"#\");\n\t\t\t\t}).map(function (i) {\n\t\t\t\t\treturn i.href.replace(not_hash, \"\");\n\t\t\t\t});\n\t\t\t\tthis.start = arg || this.routes[0];\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"sweep\",\n\t\t\tvalue: function sweep(obj, klass) {\n\t\t\t\tfrom(obj.parentNode.childNodes).filter(function (i) {\n\t\t\t\t\treturn i.nodeType === 1 && i.id && i.id !== obj.id;\n\t\t\t\t}).forEach(function (i) {\n\t\t\t\t\treturn i.classList.add(klass);\n\t\t\t\t});\n\t\t\t\tobj.classList.remove(klass);\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}]);\n\n\t\treturn Router;\n\t}();\n\n\tfunction factory(arg) {\n\t\tvar obj = new Router(arg),\n\t\t    hash = document.location.hash.replace(\"#\", \"\"),\n\t\t    facade = function facade(ev) {\n\t\t\treturn obj.hashchange.call(obj, ev);\n\t\t};\n\n\t\tif (\"addEventListener\" in window) {\n\t\t\twindow.addEventListener(\"hashchange\", facade, false);\n\t\t} else {\n\t\t\twindow.onhashchange = facade;\n\t\t}\n\n\t\tobj.scan(obj.start);\n\n\t\tif (!has(obj.css.hidden, obj.ctx.classList)) {\n\t\t\tif (hash !== \"\" && contains(obj.routes, hash)) {\n\t\t\t\tobj.hashchange({ oldURL: \"\", newURL: document.location.hash });\n\t\t\t} else {\n\t\t\t\tobj.route(obj.start);\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tfactory.version = \"2.0.0\";\n\n\t// CJS, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn factory;\n\t\t});\n\t} else {\n\t\twindow.router = factory;\n\t}\n})(document, window);\n"]}