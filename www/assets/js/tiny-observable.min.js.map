{"version":3,"sources":["tiny-observable.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","has","obj","prop","undefined","array","Array","from","iterate","fn","ctx","arguments","keys","forEach","idx","call","s","Math","random","toString","substring","uuid","substr","r","floor","factory","arg","Observable","WeakMap","require","this","limit","listeners","hooks","value","ev","_this","_len","args","_key","handler","apply","scope","_this2","ltarget","t","Error","get","dispatch","set","addEventListener","id","_this3","lscope","on","_len2","_key2","off","_this4","removeEventListener","delete","exports","module","define","amd","observable","window"],"mappings":"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","file":"tiny-observable.min.js","sourcesContent":["/**\r\n * Tiny Observable for Client and Server\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2016\r\n * @license BSD-3-Clause\r\n * @link http://avoidwork.github.io/tiny-observable\r\n * @version 1.0.3\r\n */\n\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (global) {\n\n\tvar WeakMap = global.WeakMap || require(\"es6-weak-map\");\n\tvar r = [8, 9, \"a\", \"b\"];\n\n\tfunction has(obj, prop) {\n\t\treturn obj[prop] !== undefined;\n\t}\n\n\tfunction array(obj) {\n\t\treturn obj instanceof Array ? obj : has(obj, \"length\") ? Array.from(obj) : [obj];\n\t}\n\n\tfunction iterate(obj, fn) {\n\t\tvar ctx = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : obj;\n\n\t\tObject.keys(obj).forEach(function (i, idx) {\n\t\t\tfn.call(ctx, i, idx);\n\t\t});\n\t}\n\n\tfunction s() {\n\t\treturn ((Math.random() + 1) * 0x10000 | 0).toString(16).substring(1);\n\t}\n\n\tfunction uuid() {\n\t\treturn s() + s() + \"-\" + s() + \"-4\" + s().substr(0, 3) + \"-\" + r[Math.floor(Math.random() * 4)] + s().substr(0, 3) + \"-\" + s() + s() + s();\n\t}\n\n\tvar Observable = function () {\n\t\tfunction Observable() {\n\t\t\tvar arg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;\n\n\t\t\t_classCallCheck(this, Observable);\n\n\t\t\tthis.limit = arg;\n\t\t\tthis.listeners = {};\n\t\t\tthis.hooks = new WeakMap();\n\t\t}\n\n\t\t_createClass(Observable, [{\n\t\t\tkey: \"dispatch\",\n\t\t\tvalue: function dispatch(ev) {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tfor (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t\t\t\t\targs[_key - 1] = arguments[_key];\n\t\t\t\t}\n\n\t\t\t\tif (ev && has(this.listeners, ev)) {\n\t\t\t\t\titerate(this.listeners[ev], function (i) {\n\t\t\t\t\t\tvar obj = _this.listeners[ev][i];\n\n\t\t\t\t\t\tobj.handler.apply(obj.scope, args);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"hook\",\n\t\t\tvalue: function hook(target, ev) {\n\t\t\t\tvar _this2 = this;\n\n\t\t\t\tvar ltarget = array(target);\n\n\t\t\t\tltarget.forEach(function (t) {\n\t\t\t\t\tvar obj = void 0;\n\n\t\t\t\t\tif (!has(t, \"addEventListener\")) {\n\t\t\t\t\t\tthrow new Error(\"Invalid Arguments\");\n\t\t\t\t\t}\n\n\t\t\t\t\tobj = _this2.hooks.get(t) || {};\n\n\t\t\t\t\tif (!has(obj, ev)) {\n\t\t\t\t\t\tobj[ev] = function (arg) {\n\t\t\t\t\t\t\t_this2.dispatch(ev, arg);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\t_this2.hooks.set(t, obj);\n\t\t\t\t\tt.addEventListener(ev, _this2.hooks.get(t)[ev], false);\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"off\",\n\t\t\tvalue: function off(ev, id) {\n\t\t\t\tif (has(this.listeners, ev)) {\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\tdelete this.listeners[ev][id];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete this.listeners[ev];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"on\",\n\t\t\tvalue: function on(ev, handler) {\n\t\t\t\tvar id = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : uuid();\n\t\t\t\tvar scope = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n\n\t\t\t\tif (!has(this.listeners, ev)) {\n\t\t\t\t\tthis.listeners[ev] = {};\n\t\t\t\t}\n\n\t\t\t\tif (Object.keys(this.listeners[ev]).length >= this.limit) {\n\t\t\t\t\tthrow new Error(\"Possible memory leak, more than \" + this.limit + \" listeners for event: \" + ev);\n\t\t\t\t}\n\n\t\t\t\tthis.listeners[ev][id] = {\n\t\t\t\t\tscope: scope || this,\n\t\t\t\t\thandler: handler\n\t\t\t\t};\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"once\",\n\t\t\tvalue: function once(ev, handler) {\n\t\t\t\tvar _this3 = this;\n\n\t\t\t\tvar id = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : uuid();\n\t\t\t\tvar scope = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n\n\t\t\t\tvar lscope = scope || this;\n\n\t\t\t\treturn this.on(ev, function () {\n\t\t\t\t\tfor (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t\t\t\t\t\targs[_key2] = arguments[_key2];\n\t\t\t\t\t}\n\n\t\t\t\t\thandler.apply(lscope, args);\n\t\t\t\t\t_this3.off(ev, id);\n\t\t\t\t}, id, lscope);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"unhook\",\n\t\t\tvalue: function unhook(target, ev) {\n\t\t\t\tvar _this4 = this;\n\n\t\t\t\tvar ltarget = array(target);\n\n\t\t\t\tltarget.forEach(function (t) {\n\t\t\t\t\tvar obj = void 0;\n\n\t\t\t\t\tif (!has(t, \"removeEventListener\")) {\n\t\t\t\t\t\tthrow new Error(\"Invalid Arguments\");\n\t\t\t\t\t}\n\n\t\t\t\t\tobj = _this4.hooks.get(t);\n\n\t\t\t\t\tif (obj) {\n\t\t\t\t\t\tt.removeEventListener(ev, obj[ev], false);\n\t\t\t\t\t\tdelete obj[ev];\n\n\t\t\t\t\t\tif (Object.keys(obj).length === 0) {\n\t\t\t\t\t\t\t_this4.hooks.delete(t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t_this4.hooks.set(t, obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}]);\n\n\t\treturn Observable;\n\t}();\n\n\tfunction factory(arg) {\n\t\treturn new Observable(arg);\n\t}\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn factory;\n\t\t});\n\t} else {\n\t\tglobal.observable = factory;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}